import{a as le}from"./chunk-BSWVXCA6.js";import{d as X}from"./chunk-PUKYV4E7.js";import{a as se}from"./chunk-7NGZH4SF.js";import{a as re,c as oe,j as ne,k as ae}from"./chunk-Y7H6PHVG.js";import"./chunk-4DRUEFLH.js";import{A as ie,c as ee,z as te}from"./chunk-GEVSPATW.js";import{a as Z}from"./chunk-7LPMGZKA.js";import{B as Y,D as J,E as K,F as Q,c as B,e as _,h as G,i as O,n as z,r as H,u as W,y as $}from"./chunk-N3UDIXRD.js";import{Bb as M,Ha as w,L as T,Ma as d,Qa as P,S as L,Ub as k,Wb as j,X as C,Xa as i,Y as N,Ya as r,Za as f,ca as I,cc as q,fb as v,fc as D,hb as y,j as A,tb as a,uc as R,vb as x,vc as U,xc as V,y as S,ya as m,za as c}from"./chunk-TXQBTV46.js";import"./chunk-5G567QLT.js";function pe(e,o){e&1&&(i(0,"mat-error"),a(1," Password is required. "),r())}function ue(e,o){e&1&&(i(0,"mat-error"),a(1," Password must start with an uppercase letter. "),r())}function ce(e,o){e&1&&(i(0,"mat-error"),a(1," Password must be at least 6 characters long. "),r())}function fe(e,o){e&1&&(i(0,"mat-error"),a(1," Password must include a special character. "),r())}function ge(e,o){e&1&&(i(0,"mat-error"),a(1," Password must include a number. "),r())}function he(e,o){if(e&1&&(i(0,"mat-error"),a(1),r()),e&2){let b=y(),s;m(),x(" ",(s=b.loginForm.get("password"))==null?null:s.getError("customError")," ")}}function we(e,o){if(e&1&&(i(0,"div",29),f(1,"i",30),a(2),r()),e&2){let b=y();m(2),x(" ",b.errorMessage," ")}}function ve(e,o){e&1&&(i(0,"div",31)(1,"span"),a(2,"Login"),r(),f(3,"i",32),r())}function _e(e,o){e&1&&f(0,"span",33)}var be=e=>({"border-red-500":e}),me=(()=>{let o=class o{constructor(s,u,t,p,l,n,g,h){this.ToasterService=s,this.UserAuthService=u,this.appAuthService=t,this.oAuthService=p,this.AgentProfileService=l,this.NormalAuth=n,this._router=g,this.fb=h,this.formSubmitted=!1,this.defaultAuth={mobileNo:"",password:""},this.subs=new se,this.passwordFieldType="password",this.confirmPasswordFieldType="password"}ngOnInit(){this.loadForm()}goToForgotPassword(){this._router.navigate(["/forgot-password"],{queryParams:{redirect:"agent/login"}})}loadForm(){this.loginForm=this.fb.group({mobileNo:[this.defaultAuth.mobileNo,_.required],password:[this.defaultAuth.password,_.compose([_.required])]})}onSubmit(){if(this.formSubmitted=!0,this.loginForm.invalid){this.ToasterService.customToast("Please filled all required field","warning");return}this.isLoading=!0;let s,u=this.loginForm.value.mobileNo,t=this.loginForm.value.password;this.oAuthService.oidc=!1;let p={userName:this.loginForm.value.mobileNo,email:"",password:this.loginForm.value.password,rememberMe:!1};try{this.appAuthService.isLoadingSubject.next(!0),this.oAuthService.fetchTokenUsingPasswordFlowAndLoadUserProfile(u,t).then(l=>{this.formSubmitted=!1,l&&(l?.info?.role!=="Doctor"||l?.info?.role!=="Patient")&&this.UserAuthService.loginByUserDto(p).pipe(S(n=>this.handleLoginError(n)),T(n=>(s=n,n.success?this.AgentProfileService.getByUserName(n.userName||""):(this.hasError=!0,this.ToasterService.customToast(n.message||" ","error"),A(n.message||"Login failed")))),S(n=>this.handleProfileError(n))).subscribe(n=>{console.log(n);let g={fullName:n.fullName,userId:n.userId,id:n.id,userType:s.roleName.toString().toLowerCase()};this.NormalAuth.setAuthInfoInLocalStorage(g);let h=n.isActive?s.roleName.toString().toLowerCase():(s.roleName.toString()+"/profile-settings").toLowerCase();this._router.navigate([h],{state:{data:n}}).then(()=>this.ToasterService.customToast(s.message||" ","success"))}),(l?.info?.role==="Doctor"||l?.info?.role==="Patient")&&(this.errorMessage=`You ara a ${l?.info?.role}. Please login from ${l?.info?.role} portal.`)}).catch(l=>{this.isLoading=!1,this.errorMessage=l.error?.error_description})}catch(l){console.log(l),this.hasError=!0,l.message==="'tokenEndpoint' should not be null"&&this.ToasterService.customToast(l.message||" ","success")}}handleLoginError(s){this.isLoading=!1}handleProfileError(s){this.isLoading=!1}passwordVisibility(s){s==="password"?this.passwordFieldType=this.passwordFieldType==="password"?"text":"password":s==="confirmPassword"&&(this.confirmPasswordFieldType=this.confirmPasswordFieldType==="password"?"text":"password")}ngOnDestroy(){this.subs.unsubscribe()}};o.\u0275fac=function(u){return new(u||o)(c(ie),c(te),c(le),c(X),c(ee),c(Z),c(R),c(J))},o.\u0275cmp=C({type:o,selectors:[["app-agent-login"]],decls:50,vars:17,consts:[[1,"signup-form"],[1,"signup-form__left"],["width","300","height","300","ngSrc","/assets/agent/agent-portal.jpg","alt","auth",1,"w-full","h-full","object-cover"],[1,"signup-form__right","drop-shadow-soft","relative"],[1,"max-w-lg","min-w-[500px]","mx-auto","mt-10","bg-white","p-8","rounded-xl","shadow","shadow-slate-300"],[1,"text-4xl","font-bold","font-Roboto"],[1,"text-slate-500","mt-2"],["href","/"],["action","",1,"mt-6",3,"formGroup","submit"],[1,"flex","flex-col","space-y-5","mt-10"],["for","mobile"],[1,"font-medium","text-slate-700","pb-2"],[1,"form_input","flex","h-[40px]",3,"ngClass"],["matPrefix","",1,"h-fit","font-Roboto"],["matInput","","maxlength","11","type","tel","formControlName","mobileNo","id","mobileNo","placeholder","018-000-00000","required","","inputmode","numeric",1,"w-full","border-none","outline-none","font-Roboto","h-fit"],["for","Password"],[1,"form_input","flex","justify-between"],["formControlName","password","name","password","id","password","placeholder","Password123@*",1,"w-full","outline-none",3,"type"],[1,"cursor-pointer",3,"click"],[1,"flex","flex-col"],[4,"ngIf"],["class","p-4 mb-4 text-sm text-yellow-800 rounded-lg bg-yellow-50 font-semibold font-Roboto","role","alert",4,"ngIf"],["type","submit",1,"form_btn","disabled:bg-gray-500","disabled:select-none",3,"disabled"],["class","flex items-center",4,"ngIf"],["class","loading loading-dots loading-md",4,"ngIf"],[1,"text-center"],["routerLink","/agent/signup",1,"text-primary","font-medium","inline-flex","space-x-1","items-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"h-4","w-4"],["stroke-linecap","round","stroke-linejoin","round","d","M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"],["role","alert",1,"p-4","mb-4","text-sm","text-yellow-800","rounded-lg","bg-yellow-50","font-semibold","font-Roboto"],[1,"fa-solid","fa-circle-exclamation","mr-2"],[1,"flex","items-center"],[1,"fa-solid","ml-2","fa-right-to-bracket"],[1,"loading","loading-dots","loading-md"]],template:function(u,t){if(u&1&&(i(0,"div",0)(1,"div",1),f(2,"img",2),r(),i(3,"div",3)(4,"div",4)(5,"h1",5),a(6,"Agent Login"),r(),i(7,"p",6),a(8,"Hi, Welcome to SoowGood \u{1F44B}"),r(),i(9,"a",7),a(10,"Back to home"),r(),i(11,"form",8),v("submit",function(){return t.onSubmit()}),i(12,"div",9)(13,"label",10)(14,"p",11),a(15,"Mobile Number"),r(),i(16,"div",12)(17,"span",13),a(18,"+88 \xA0"),r(),f(19,"input",14),r()(),i(20,"label",15)(21,"p",11),a(22,"Password"),r(),i(23,"div",16),f(24,"input",17),i(25,"span",18),v("click",function(){return t.passwordVisibility("password")}),f(26,"i"),r()(),i(27,"div",19),w(28,pe,2,0,"mat-error",20)(29,ue,2,0,"mat-error",20)(30,ce,2,0,"mat-error",20)(31,fe,2,0,"mat-error",20)(32,ge,2,0,"mat-error",20)(33,he,2,1,"mat-error",20),r()(),w(34,we,3,1,"div",21),i(35,"p"),a(36," Forgot your password?"),i(37,"strong",18),v("click",function(){return t.goToForgotPassword()}),a(38," Reset now"),r()(),i(39,"button",22),w(40,ve,4,0,"div",23)(41,_e,1,0,"span",24),r(),i(42,"p",25),a(43," Don't have an account? "),i(44,"a",26)(45,"span"),a(46,"Sign up "),r(),i(47,"span"),I(),i(48,"svg",27),f(49,"path",28),r()()()()()()()()()),u&2){let p,l,n,g,h,E,F;m(11),d("formGroup",t.loginForm),m(5),d("ngClass",M(15,be,((p=t.loginForm.get("mobileNo"))==null?null:p.invalid)&&((p=t.loginForm.get("mobileNo"))==null?null:p.touched))),m(8),d("type",t.passwordFieldType),m(2),P(t.passwordFieldType==="password"?"fa fa-eye-slash":"fa fa-eye"),m(2),d("ngIf",t.formSubmitted&&((l=t.loginForm.get("password"))==null?null:l.hasError("required"))),m(),d("ngIf",t.formSubmitted&&((n=t.loginForm.get("password"))==null?null:n.hasError("startsWithUppercase"))),m(),d("ngIf",t.formSubmitted&&((g=t.loginForm.get("password"))==null?null:g.hasError("isAtLeast6Characters"))),m(),d("ngIf",t.formSubmitted&&((h=t.loginForm.get("password"))==null?null:h.hasError("includesSpecialCharacter"))),m(),d("ngIf",t.formSubmitted&&((E=t.loginForm.get("password"))==null?null:E.hasError("includesNumber"))),m(),d("ngIf",(F=t.loginForm.get("password"))==null?null:F.hasError("customError")),m(),d("ngIf",t.errorMessage),m(5),d("disabled",t.isLoading||!t.loginForm.dirty||t.loginForm.invalid),m(),d("ngIf",!t.isLoading),m(),d("ngIf",t.isLoading)}},dependencies:[k,j,U,z,B,G,O,$,Y,H,W,ne,re,oe,D]});let e=o;return e})();var Se=[{path:"",component:me}],Oe=(()=>{let o=class o{};o.\u0275fac=function(u){return new(u||o)},o.\u0275mod=N({type:o}),o.\u0275inj=L({imports:[q,V.forChild(Se),K,Q,ae]});let e=o;return e})();export{Oe as AgentLoginModule};
