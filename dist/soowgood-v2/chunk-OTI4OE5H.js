import{a as Qe}from"./chunk-HZPAFMDX.js";import{d as We,e as $e}from"./chunk-LOJM2DH5.js";import{a as qe}from"./chunk-HD67J5K4.js";import{a as Ve,b as Oe}from"./chunk-JQBLBVRI.js";import{b as Be}from"./chunk-UGVBX5RU.js";import{a as Ue}from"./chunk-7NGZH4SF.js";import{c as je,d as Re}from"./chunk-EOAKK2OL.js";import{j as Ge}from"./chunk-JN5TIQFO.js";import{a as Me,d as Ae,g as H}from"./chunk-KXUW234Y.js";import{a as Ee,b as Fe}from"./chunk-KZ73FH3X.js";import{q as Ne,s as Pe,z as Le}from"./chunk-B6XPZLTG.js";import{a as Te}from"./chunk-6E6ZED7T.js";import{A as De,C as Ce,c as fe,e as v,h as ge,i as he,n as _e,p as ve,r as xe,u as be,v as Se,w as ye,x as ke,y as we,z as Ie}from"./chunk-FUUASHDU.js";import{$a as se,Ha as p,Hb as ce,K as G,L as re,Na as d,R as ae,Vb as $,Wb as A,X as M,Ya as i,Za as t,_a as f,aa as k,ab as de,ba as w,ca as Y,cb as L,d as te,da as le,e as Q,fc as pe,gb as I,i as ie,ib as g,m as q,qb as j,rb as R,sb as U,tb as W,ub as r,v as oe,vb as z,vc as ue,wb as P,xb as me,ya as s,z as ne,za as T}from"./chunk-PJQ4EZIT.js";import{a as Z,b as ee}from"./chunk-5G567QLT.js";var V=(()=>{let a=class a{constructor(){this.doctorSlotList=new Q([]),this.doctorScheduleList=new Q([]),this.selectedSlot=new te}sendDoctorAvailableSlotData(e){this.doctorSlotList.next(e)}getDoctorAvailableSlotData(){return this.doctorSlotList.asObservable()}sendDoctorScheduleData(e){this.doctorScheduleList.next(e)}getDoctorScheduleData(){return this.doctorScheduleList.asObservable()}sendSelectedSlot(e){this.selectedSlot.next(e)}getSelectedSlot(){return this.selectedSlot.asObservable()}};a.\u0275fac=function(n){return new(n||a)},a.\u0275prov=ae({token:a,factory:a.\u0275fac,providedIn:"root"});let o=a;return o})();function Xe(o,a){if(o&1){let l=L();i(0,"div",1),f(1,"input",2),i(2,"label",3),I("click",function(){k(l);let n=g();return w(n.selectSlot(n.item))}),i(3,"div",4),f(4,"span",5),i(5,"div",6)(6,"p",7),r(7),t()(),i(8,"p",7),r(9),t()()()()}if(o&2){let l=g();s(),d("id",l.item.id)("value",l.item.id),s(),d("for",l.item.id),s(5),me("",l.formatTime(l.item.startTime)," - ",l.formatTime(l.item.endTime),""),s(2),P("(",l.item.leftSlot," slot available)")}}var ze=(()=>{let a=class a{constructor(e){this.DoctorScheduleStateService=e}selectSlot(e){this.DoctorScheduleStateService.sendSelectedSlot(e)}formatTime(e){return new Date(`1970-01-01T${e}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})}};a.\u0275fac=function(n){return new(n||a)(T(V))},a.\u0275cmp=M({type:a,selectors:[["app-slot-item"]],inputs:{item:"item"},decls:1,vars:1,consts:[["class","flex items-center",4,"ngIf"],[1,"flex","items-center"],["hidden","","type","radio","name","default-radio",1,"w-4","h-4","text-blue-600","bg-gray-100","border-gray-300","focus:ring-blue-500","focus:ring-2",3,"id","value"],[1,"radio-card","flex","py-2","px-3","border-[1px]","border-secondary-dark/20","bg-secondary-light","text-secondary-dark","cursor-pointer",3,"for","click"],[1,"card-content-wrapper"],[1,"check-icon"],[1,"card-content","tooltip"],[1,"text-[14px]"]],template:function(n,m){n&1&&p(0,Xe,10,6,"div",0),n&2&&d("ngIf",m.item.leftSlot)},dependencies:[A],styles:["input[type=radio][_ngcontent-%COMP%]:checked + .radio-card[_ngcontent-%COMP%]{background:#006c93;color:#fff}"]});let o=a;return o})();function et(o,a){if(o&1&&(i(0,"div"),f(1,"app-slot-item",3),t()),o&2){let l=a.$implicit;s(),d("item",l)}}function tt(o,a){o&1&&(i(0,"p"),r(1,"No slot is available!"),t())}var He=(()=>{let a=class a{constructor(e){this.DoctorScheduleStateService=e,this.slotList=[],this.DoctorScheduleStateService.getDoctorAvailableSlotData().pipe(oe(n=>n)).subscribe(n=>{console.log(n),this.slotList=n})}};a.\u0275fac=function(n){return new(n||a)(T(V))},a.\u0275cmp=M({type:a,selectors:[["app-slots"]],decls:3,vars:2,consts:[[1,"grid","grid-cols-3","gap-3"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"item"]],template:function(n,m){n&1&&(i(0,"div",0),p(1,et,2,1,"div",1)(2,tt,2,0,"p",2),t()),n&2&&(s(),d("ngForOf",m.slotList),s(),d("ngIf",m.slotList.length<1))},dependencies:[$,A,ze]});let o=a;return o})();var ot=["buttonMyself"],nt=["buttonOthers"];function rt(o,a){if(o&1){let l=L();i(0,"div",2)(1,"div",3),f(2,"img",4),i(3,"h1",5),r(4,"Welcome to Soowgood."),t()(),i(5,"div",6)(6,"p"),r(7," You must be "),i(8,"a",7),I("click",function(){k(l);let n=g();return w(n.dialogRef.close())}),r(9,"Login! "),t(),r(10," to continue! "),t(),i(11,"p"),r(12,"or"),t(),i(13,"p")(14,"a",8),I("click",function(){k(l);let n=g();return w(n.dialogRef.close())}),r(15,"Register"),t(),r(16," a new account. "),t()()()}}function at(o,a){o&1&&(i(0,"div",15),r(1,"Loading..."),t())}function lt(o,a){if(o&1){let l=L();i(0,"li",23),I("click",function(){k(l);let n=g(3);return w(n.onStepChange(1))}),f(1,"input",75),i(2,"label",76)(3,"div",26),f(4,"i",77),i(5,"div")(6,"div",28),r(7," Book for Self "),t(),i(8,"div",29),r(9,"If you are patient!"),t()()(),Y(),i(10,"svg",30),f(11,"path",31),t()()()}}function st(o,a){o&1&&(i(0,"p",98),r(1," Please select appointment date. "),t())}function dt(o,a){if(o&1&&(i(0,"option",99),r(1),t()),o&2){let l=a.$implicit;d("value",l.id),s(),P(" ",l.name," ")}}function mt(o,a){o&1&&(i(0,"p",98),r(1," Please select a hospital/chamber "),t())}function ct(o,a){if(o&1&&(i(0,"option",99),r(1),t()),o&2){let l=a.$implicit;d("value",l.id),s(),P(" ",l.name," ")}}function pt(o,a){o&1&&(i(0,"p",98),r(1," Please select appointment type "),t())}function ut(o,a){o&1&&(i(0,"div",15)(1,"label",100),r(2," Available Slots"),t(),i(3,"div",101),f(4,"app-slots"),t()())}function ft(o,a){if(o&1&&(i(0,"div",15)(1,"p"),r(2),t()()),o&2){let l=g(4);s(2),z(l.showEmptySlot)}}function gt(o,a){if(o&1){let l=L();i(0,"div")(1,"form",20)(2,"div",78)(3,"div",79)(4,"div",80),f(5,"img",81),t(),i(6,"div",82)(7,"h2",83),r(8),t(),i(9,"p"),r(10),t()()(),i(11,"div",84)(12,"div",85)(13,"div",86),r(14,"Total Fee"),t(),i(15,"div",87),r(16),t()()()(),f(17,"hr",88),i(18,"div",43)(19,"div",44)(20,"div",45)(21,"label",53),r(22," Appointment Date "),t(),i(23,"input",89),I("click",function(){k(l);let n=W(25);return w(n.open())}),t(),f(24,"mat-datepicker",null,90),p(26,st,2,0,"p",57),t()(),i(27,"div",44)(28,"div",45)(29,"label",91),r(30," Select place "),t(),i(31,"select",92)(32,"option",55),r(33," Select hospital/chamber "),t(),p(34,dt,2,2,"option",93),t(),p(35,mt,2,0,"p",57),t()(),i(36,"div",44)(37,"div",45)(38,"label",53),r(39," Select appointment type "),t(),i(40,"select",94)(41,"option",55),r(42," Select appointment type "),t(),p(43,ct,2,2,"option",93),t(),p(44,pt,2,0,"p",57),t()()()(),p(45,ut,5,0,"div",13)(46,ft,3,1,"div",13),i(47,"div",95)(48,"button",96),I("click",function(){k(l);let n=g(3);return w(n.onStepChange(0))}),r(49," Back "),t(),i(50,"button",97),I("click",function(){k(l);let n=g(3);return w(n.onStepChange(3))}),r(51),t()()()}if(o&2){let l=W(25),e=g(3),n,m,b;s(),d("formGroup",e.form),s(4),d("ngSrc",(e.doctorData.doctorDetails==null?null:e.doctorData.doctorDetails.picUrl)||"/doctor/dr.jpeg"),s(3),P(" ",e.doctorData==null?null:e.doctorData.doctorDetails.fullName," "),s(2),z(e.doctorData==null?null:e.doctorData.doctorDetails.areaOfExperties),s(6),P(" ",e.totalFee?e.totalFee:"00",".0 tk. "),s(7),d("matDatepickerFilter",e.dateFilter)("matDatepicker",l)("max",e.maxDate)("min",e.minDate)("matDatepicker",l),s(3),d("ngIf",e.formSubmitted&&((n=e.form.get("appointmentDate"))==null?null:n.hasError("required"))),s(8),d("ngForOf",e.hospitalList),s(),d("ngIf",e.formSubmitted&&((m=e.form.get("doctorScheduleType"))==null?null:m.value)==="0"),s(8),d("ngForOf",e.appointmentType),s(),d("ngIf",e.formSubmitted&&((b=e.form.get("appointmentType"))==null?null:b.value)==="0"),s(),d("ngIf",(e.filterData==null?null:e.filterData.length)>0),s(),d("ngIf",(e.filterData==null?null:e.filterData.length)<=0&&e.showEmptySlot!==""),s(5),P(" ",e.isLoading?"Loading...":"Next"," ")}}function ht(o,a){o&1&&r(0," Data is loading... ")}function _t(o,a){if(o&1&&(i(0,"option",105),r(1),t()),o&2){let l=a.$implicit;d("value",l.id),s(),P(" ",l.name," ")}}function vt(o,a){if(o&1){let l=L();i(0,"div")(1,"label",102),r(2,"Select your patient"),t(),se(3),i(4,"select",103),I("input",function(n){k(l);let m=g(3);return w(m.getSinglePatientData(n))}),i(5,"option",104),r(6,"--Select Patient--"),t(),p(7,_t,2,2,"option",56),t(),de(),t()}if(o&2){let l=g(3);s(4),d("value",l.value),s(3),d("ngForOf",l.userPatientList)}}function xt(o,a){o&1&&(i(0,"p",106),r(1," Please enter patient name. "),t())}function bt(o,a){o&1&&(i(0,"p",106),r(1," Patient name should contain only letters and numbers at the end (optional). "),t())}function St(o,a){o&1&&(i(0,"p",106),r(1," Patient name should be at least 3 characters long "),t())}function yt(o,a){o&1&&(i(0,"p",106),r(1," Please enter patient age. "),t())}function kt(o,a){o&1&&(i(0,"p",106),r(1," Age should be a number. "),t())}function wt(o,a){o&1&&(i(0,"p",106),r(1," You must enter a valid mobile number! "),t())}function It(o,a){o&1&&(i(0,"p",106),r(1," Mobile number should have exactly 11 digits and follow the Bangladeshi format! "),t())}function Dt(o,a){if(o&1&&(i(0,"option",105),r(1),t()),o&2){let l=a.$implicit;d("value",l.id),s(),P(" ",l.name," ")}}function Ct(o,a){o&1&&(i(0,"p",98),r(1," Please select gender! "),t())}function Et(o,a){o&1&&(i(0,"p",98),r(1," Please select blood group! "),t())}function Ft(o,a){o&1&&(i(0,"div",107)(1,"span"),r(2,"Continue"),t()())}function Tt(o,a){o&1&&f(0,"span",108)}function Nt(o,a){if(o&1){let l=L();i(0,"div",16)(1,"mat-stepper",17,18)(3,"mat-step",19)(4,"form",20)(5,"ul",21),p(6,lt,12,0,"li",22),i(7,"li",23),I("click",function(){k(l);let n=g(2);return w(n.onStepChange(2))}),f(8,"input",24),i(9,"label",25)(10,"div",26),f(11,"i",27),i(12,"div")(13,"div",28),r(14,"Book Someone"),t(),i(15,"div",29),r(16,"If someone is patient!"),t()()(),Y(),i(17,"svg",30),f(18,"path",31),t()()()()()(),le(),i(19,"mat-step",32),p(20,gt,52,18,"div",33)(21,ht,1,0,"ng-template",null,34,ce),t(),i(23,"mat-step",19)(24,"div",35)(25,"div",36)(26,"input",37),I("click",function(){k(l);let n=g(2);return w(n.userExistCheck("exist-user"))}),t(),i(27,"label",38),r(28," Already Exist "),t()(),i(29,"div",36)(30,"input",39),I("click",function(){k(l);let n=g(2);return w(n.userExistCheck("new-user"))}),t(),i(31,"label",40),r(32," New Patient "),t()()(),i(33,"div",41),p(34,vt,8,2,"div",1),i(35,"div",41)(36,"form",42)(37,"div",43)(38,"div",44)(39,"div",45)(40,"label",46),r(41," Full Name "),t(),f(42,"input",47),p(43,xt,2,0,"p",48)(44,bt,2,0,"p",48)(45,St,2,0,"p",48),t()(),i(46,"div",44)(47,"div",45)(48,"label",49),r(49," Age "),t(),f(50,"input",50),p(51,yt,2,0,"p",48)(52,kt,2,0,"p",48),t()(),i(53,"div",44)(54,"div",45)(55,"label",51),r(56," Patient Mobile No "),t(),f(57,"input",52),p(58,wt,2,0,"p",48)(59,It,2,0,"p",48),t()(),i(60,"div",44)(61,"div",45)(62,"label",53),r(63," Select gender "),t(),i(64,"select",54)(65,"option",55),r(66," Select gender "),t(),p(67,Dt,2,2,"option",56),t(),p(68,Ct,2,0,"p",57),t()(),i(69,"div",44)(70,"div",45)(71,"label",58),r(72," Select blood group "),t(),i(73,"select",59)(74,"option",55),r(75," Select blood group "),t(),i(76,"option",60),r(77," A+ "),t(),i(78,"option",61),r(79," A- "),t(),i(80,"option",62),r(81," B+ "),t(),i(82,"option",63),r(83," B- "),t(),i(84,"option",64),r(85," O+ "),t(),i(86,"option",65),r(87," O- "),t(),i(88,"option",66),r(89," AB+ "),t(),i(90,"option",67),r(91," AB- "),t(),i(92,"option",68),r(93," others "),t()(),p(94,Et,2,0,"p",57),t()()()()()(),i(95,"div",69)(96,"button",70),I("click",function(){k(l);let n=g(2);return w(n.onStepChange(0))}),r(97," Back "),t(),i(98,"button",71),I("click",function(){k(l);let n=g(2);return w(n.createNewPatient())}),p(99,Ft,3,0,"div",72)(100,Tt,1,0,"span",73),t()()(),i(101,"mat-step",19)(102,"app-booking-review",74),I("gotToBack",function(n){k(l);let m=g(2);return w(m.onStepChange(n))}),t()()()()}if(o&2){let l=W(22),e=g(2),n,m,b,E,S,D,N,C,h;s(),d("selectedIndex",e.activeTab),s(2),d("stepControl",e.firstFormGroup),s(),d("formGroup",e.bookingForm),s(2),d("ngIf",e.sessionRole=="patient"),s(13),d("stepControl",e.secondFormGroup)("ariaSelected",e.activeTab),s(),d("ngIf",!e.dataLoader)("ngIfElse",l),s(3),d("stepControl",e.thirdFormGroup),s(11),d("ngIf",e.isExistUser),s(2),d("formGroup",e.createPatientForm),s(7),d("ngIf",e.formSubmitted&&((n=e.createPatientForm.get("patientName"))==null?null:n.hasError("required"))),s(),d("ngIf",e.formSubmitted&&((m=e.createPatientForm.get("patientName"))==null?null:m.hasError("pattern"))),s(),d("ngIf",e.formSubmitted&&((b=e.createPatientForm.get("patientName"))==null?null:b.hasError("invalidName"))),s(6),d("ngIf",e.formSubmitted&&((E=e.createPatientForm.get("age"))==null?null:E.hasError("required"))),s(),d("ngIf",e.formSubmitted&&((S=e.createPatientForm.get("age"))==null?null:S.hasError("pattern"))),s(6),d("ngIf",e.formSubmitted&&((D=e.createPatientForm.get("patientMobileNo"))==null?null:D.hasError("required"))),s(),d("ngIf",e.formSubmitted&&((N=e.createPatientForm.get("patientMobileNo"))==null?null:N.hasError("pattern"))),s(8),d("ngForOf",e.genderList),s(),d("ngIf",e.formSubmitted&&(((C=e.createPatientForm.get("gender"))==null?null:C.value)==="0"||((C=e.createPatientForm.get("gender"))==null?null:C.value)==null)),s(26),d("ngIf",e.formSubmitted&&(((h=e.createPatientForm.get("bloodGroup"))==null?null:h.value)==="0"||((h=e.createPatientForm.get("bloodGroup"))==null?null:h.value)===null)),s(5),d("ngIf",e.btnLoader==!1),s(),d("ngIf",e.btnLoader==!0),s(),d("stepControl",e.fourFormGroup),s(),d("bookingInfo",e.bookingInfo)}}function Pt(o,a){if(o&1){let l=L();i(0,"div")(1,"div",9)(2,"h1",10),f(3,"i",11),r(4),t(),i(5,"button",12),I("click",function(){k(l);let n=g();return w(n.closeDialogs())}),r(6,"Close"),t()(),p(7,at,2,0,"div",13)(8,Nt,103,25,"div",14),t()}if(o&2){let l=g();s(4),P(" Booking ",l.stepHeading," "),s(3),d("ngIf",l.dataLoader),s(),d("ngIf",!l.dataLoader)}}var ti=(()=>{let a=class a{constructor(e,n,m,b,E,S,D,N,C){this.fb=e,this.UserinfoStateService=n,this.PatientProfileService=m,this.FinancialSetupService=b,this.TosterService=E,this.DoctorScheduleStateService=S,this.NormalAuth=D,this.dialogRef=N,this.doctorData=C,this.isBookMyselfClick=!1,this.isBookOther=!1,this.isNewUser=!1,this.isExistUser=!0,this.btnLoader=!1,this.userPatientList=[],this.serviceFeeList=[],this.showAppointmentTypeSelectBox=!0,this.stepHeading="",this.dataLoader=!1,this.hasValidCode=!1,this.createNewPatientInfo={},this.alreadyExistPatient={},this.disabledDays=[],this.subs=new Ue,this.formSubmitted=!1,this.showEmptySlot="",this.filteredChamber=[],this.isLoading=!1,this.dateFilter=B=>{if(!B)return!1;let O=B.getDay();return!this.disabledDays.includes(O)},this.inputForCreatePatient=We,this.firstFormGroup=this.fb.group({firstCtrl:["",v.required]}),this.secondFormGroup=this.fb.group({secondCtrl:["",v.required]});let h=new Date,c=h.getFullYear(),y=h.getMonth(),_=h.getDate();this.minDate=new Date(c,y,_);let x=new Date(h);x.setDate(h.getDate()+30),this.maxDate=x}ngOnInit(){this.dataLoader=!0,this.sessionRole=this.NormalAuth.authInfo()?.userType,this.selectedSlotInfo="",this.appointmentType=H.getEnumList(Me),this.genderList=H.getEnumList(Ae),this.FinancialSetupService.getList().subscribe(c=>{this.serviceFeeList=c}),this.DoctorScheduleStateService.getSelectedSlot().pipe().subscribe(c=>{this.selectedSlotInfo=c});let e=this.doctorData.doctorScheduleInfo,n=this.NormalAuth.authInfo()?.id;n&&(this.sessionRole=="patient"&&this.UserinfoStateService.getUserPatientInfo(n,"patient"),this.sessionRole=="agent"&&this.UserinfoStateService.getUserPatientInfo(n,"agent"),this.UserinfoStateService.getData().pipe(re(c=>(this.profileInfo=c,this.loadForm(),this.dataLoader=!1,c?this.UserinfoStateService.getUserPatientData().pipe(q(y=>y?.map(_=>({name:_.patientName,id:_.id})))):ie([])))).subscribe(c=>{this.userPatientList=c}));let m=this.form.get("appointmentDate")?.valueChanges.pipe(G(this.form.get("appointmentDate")?.value)),b=this.form.get("doctorScheduleType")?.valueChanges.pipe(G(this.form.get("doctorScheduleType"))),E=this.form.get("appointmentType")?.valueChanges.pipe(G(this.form.get("appointmentType")?.value)),S=e.map(c=>c.doctorScheduleDaySession.map(y=>y.scheduleDayofWeek)).flat(),D=c=>["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].indexOf(c),N=[0,1,2,3,4,5,6],C=[...new Set(S)].map(D);this.disabledDays=N.filter(c=>!C.includes(c));let h="";m.pipe(q(c=>(h=$e(String(c)),e.filter(_=>_.doctorScheduleDaySession.some(x=>x.scheduleDayofWeek===h)).map(_=>({name:_.scheduleName,id:_.scheduleName}))))).subscribe(c=>{this.hospitalList=c}),b.pipe(q(c=>{let y=e.find(x=>x.scheduleName===c)?.doctorScheduleDaySession.filter(x=>x.scheduleDayofWeek===h),_=e.find(x=>x.scheduleName===c);return{sessions:y,updatedSchedule:_}})).subscribe(({sessions:c,updatedSchedule:y})=>{console.log(y);let _=c?.map(x=>{let B=y?.appointments?.filter(O=>O.doctorScheduleDaySessionId==x.id)?.length;return ee(Z({},x),{leftSlot:x.noOfPatients-B})});this.filterData=_,this.DoctorScheduleStateService.sendDoctorAvailableSlotData(_)}),b.pipe(ne(E)).subscribe(c=>{if(c[1]==0){this.totalFee=0;return}let y=e.filter(_=>_.scheduleName===c[0]);y?y.map(_=>{console.log(_);let x=_.doctorFeesSetup.find(B=>B.appointmentType==c[1]?B.totalFee:"");if(!x){this.TosterService.customToast("Fee not found your selected appointment type!","warning"),this.totalFee=0;return}this.totalFee=x?.totalFee,this.selectedFeesInfo=x}):this.TosterService.customToast("Fee not found your selected appointment type!","warning")})}isDayAvailable(e,n){return e.filter(m=>m.scheduleDayofWeek===n)}loadForm(){this.bookingForm=this.fb.group({bookMyself:[""],bookOther:[""],patientName:["",v.required],age:["",v.required],mobile:["",v.required]}),this.form=this.fb.group({consultancyType:[""],doctorScheduleType:["0",v.required],appointmentDate:["",v.required],appointmentType:["0",v.required]}),this.createPatientForm=this.fb.group({isSelf:[!1,v.required],patientName:["",v.required],patientProfileId:[""],age:["",[v.required,v.pattern(/^[1-9][0-9]{0,2}$/)]],gender:["0",v.required],bloodGroup:["0",v.required],patientMobileNo:["",[v.required,v.pattern(/^(?:88)?[0-9]{11}$/)]],patientEmail:[this.profileInfo?.email||"admin@gmail.com",v.required],createdBy:[this.profileInfo.fullName,v.required],creatorEntityId:[this.profileInfo.id,v.required],creatorRole:[this.sessionRole=="patient"?"patient":"agent",v.required]})}onStepChange(e){if(e>=0&&e<3&&(this.activeTab=e),e===3&&this.form.valid){if(this.isLoading=!0,this.formSubmitted=!0,this.filterData.length<=0&&!this.selectedSlotInfo?.doctorScheduleId){this.TosterService.customToast("No slot found your selected options!","warning");return}let{doctorScheduleId:n,id:m,scheduleDayofWeek:b}=this.selectedSlotInfo,E=this.doctorData.doctorScheduleInfo.find(S=>S.id===n);if(E&&E.consultancyType){let S="",D="",N=0,C=0,h=0,c=0;this.sessionRole=="agent"&&(E.consultancyType==1?(D=this.serviceFeeList.find(u=>u.platformFacilityId==4)?.externalAmountIn,C=this.serviceFeeList.find(u=>u.platformFacilityId==4&&u.externalAmountIn==D)?.externalAmount,D=="Percentage"?c=this.selectedFeesInfo.totalFee*(C/100):D=="Flat"&&(c=C)):E.consultancyType==2&&(D=this.serviceFeeList.find(u=>u.platformFacilityId==5)?.externalAmountIn,C=this.serviceFeeList.find(u=>u.platformFacilityId==5&&u.externalAmountIn==D)?.externalAmount,D=="Percentage"?c=this.selectedFeesInfo.totalFee*(C/100):D=="Flat"&&(c=C))),E.consultancyType==1?(S=this.serviceFeeList.find(u=>u.platformFacilityId==1)?.amountIn,N=this.serviceFeeList.find(u=>u.platformFacilityId==1&&u.amountIn==S)?.amount,S=="Percentage"?h=this.selectedFeesInfo.totalFee*(N/100):S=="Flat"&&(h=N)):E.consultancyType==2&&(S=this.serviceFeeList.find(u=>u.platformFacilityId==2)?.amountIn,N=this.serviceFeeList.find(u=>u.platformFacilityId==2&&u.amountIn==S)?.amount,S=="Percentage"?h=this.selectedFeesInfo.totalFee*(N/100):S=="Flat"&&(h=N)),this.formSubmitted=!0;let{consultancyType:y,doctorChamberId:_,doctorProfileId:x,scheduleType:B,chamber:O}=E,{appointmentType:Je,appointmentDate:Ke}=this.form.value,F="";this.UserinfoStateService.getData().subscribe(u=>F=u);let X={doctorScheduleId:n,doctorProfileId:x,doctorName:this.doctorData?.doctorDetails.fullName,doctorCode:this.doctorData?.doctorDetails.doctorCode,patientProfileId:this.alreadyExistPatient?.id?this.alreadyExistPatient?.id:this.createNewPatientInfo.id?this.createNewPatientInfo?.id:F?.id,patientName:this.alreadyExistPatient?.patientName?this.alreadyExistPatient?.patientName:this.createNewPatientInfo?.patientName?this.createNewPatientInfo?.patientName:F?.fullName,patientCode:this.alreadyExistPatient?.patientCode?this.alreadyExistPatient?.patientCode:this.createNewPatientInfo?.patientCode?this.createNewPatientInfo?.patientCode:F?.patientCode,patientMobileNo:this.alreadyExistPatient?.patientMobileNo?this.alreadyExistPatient?.patientMobileNo:this.createNewPatientInfo?.patientMobileNo?this.createNewPatientInfo?.patientMobileNo:F?.mobileNo,patientEmail:this.alreadyExistPatient?.patientEmail?this.alreadyExistPatient?.patientEmail:this.createNewPatientInfo?.patientEmail?this.createNewPatientInfo?.patientEmail:F.email||"admin@gmail.com",consultancyType:y,doctorChamberId:_,scheduleType:B,doctorScheduleDaySessionId:m,scheduleDayofWeek:b,appointmentType:Je,appointmentDate:Ke,appointmentTime:"",doctorFeesSetupId:this.selectedFeesInfo.id,doctorFee:this.selectedFeesInfo.totalFee,agentFee:c,platformFee:h,totalAppointmentFee:this.selectedFeesInfo.totalFee+h+c,appointmentStatus:1,appointmentPaymentStatus:2,appointmentCreatorId:F?.id,appointmentCreatorRole:this.sessionRole=="patient"?"patient":"agent"};if(X&&F){if(this.bookingInfo=X,this.formSubmitted=!0,this.bookingForm.get("bookMyself")?.value=="bookMyself"){let u={id:F?.id,patientName:F.fullName,patientCode:F.patientCode,patientEmail:F.email?F.email:"admin@gmail.com",patientMobileNo:F.mobileNo};this.PatientProfileService.update(u).subscribe(Bt=>{this.activeTab=e,this.isLoading=!1})}this.bookingForm.get("bookOther")?.value=="bookOther"&&(this.activeTab=e,this.isLoading=!1);return}}else this.formSubmitted=!0,this.TosterService.customToast("Please select a slot","warning"),this.isLoading=!1}else if(e===3&&!this.form.valid)this.formSubmitted=!0,this.TosterService.customToast("Please select all the required fields","warning"),this.isLoading=!1;else return}userExistCheck(e){switch(this.createPatientForm.get("patientName")?.reset(),this.createPatientForm.get("age")?.reset(),this.createPatientForm.get("gender")?.reset(),this.createPatientForm.get("bloodGroup")?.reset(),this.createPatientForm.get("patientMobileNo")?.reset(),e){case"new-user":this.isNewUser=!0,this.isExistUser=!1;return;case"exist-user":this.isNewUser=!1,this.isExistUser=!0;return;default:break}}createNewPatient(){if(this.formSubmitted=!0,!this.createPatientForm.valid){this.TosterService.customToast("Please field all the required fields","warning");return}if(this.isNewUser)try{this.btnLoader=!0,this.PatientProfileService.create(this.createPatientForm.value).subscribe(e=>{e.patientCode&&e.patientMobileNo&&this.PatientProfileService.getByPhoneAndCode(e.patientCode,e.patientMobileNo).subscribe(n=>{this.createNewPatientInfo=n}),this.btnLoader=!1,this.TosterService.customToast("Your patient is created!","success"),this.UserinfoStateService.getUserPatientInfo(this.profileInfo.id,"patient"),this.onStepChange(1)})}catch{this.TosterService.customToast("Something wrong! Please retry","error")}else this.onStepChange(1)}getSinglePatientData(e){e.target.value&&this.UserinfoStateService.getUserPatientData().subscribe(n=>n.find(m=>{m.id==e.target.value&&(this.alreadyExistPatient=m,this.createPatientForm.patchValue({patientProfileId:m.id,age:m.age,gender:m.gender,bloodGroup:m.bloodGroup,patientMobileNo:m.patientMobileNo,patientEmail:m.patientEmail,patientName:m.patientName,createdBy:m.createdBy,creatorEntityId:m.creatorEntityId,creatorRole:m.creatorRole}))}))}closeDialogs(){this.selectedSlotInfo="",this.dialogRef.close(!1)}};a.\u0275fac=function(n){return new(n||a)(T(Ce),T(Be),T(Pe),T(Ne),T(Le),T(V),T(Te),T(Ee),T(Fe))},a.\u0275cmp=M({type:a,selectors:[["app-booking-dialog"]],viewQuery:function(n,m){if(n&1&&(j(ot,5),j(nt,5),j(Qe,5)),n&2){let b;R(b=U())&&(m.buttonMyself=b.first),R(b=U())&&(m.buttonOthers=b.first),R(b=U())&&(m.customInputs=b)}},decls:2,vars:2,consts:[["class","bg-white h-[300px]",4,"ngIf"],[4,"ngIf"],[1,"bg-white","h-[300px]"],[1,"bg-primary","h-[100px]","w-full","flex","flex-col","justify-center","items-center"],["ngSrc","assets/logo.svg","alt","logo","width","50","height","50"],[1,"text-white","text-[24px]","font-roboto"],[1,"p-8","flex","justify-center","items-center","flex-col"],["routerLink","/login",1,"text-blue-500","font-bold",3,"click"],["routerLink","/signup",1,"text-blue-500","font-bold",3,"click"],[1,"flex","justify-between","py-4","px-6","border-b-[1px]","items-center"],[1,"dashbord-heading-text"],[1,"mr-1","text-[18px]","fa-solid","fa-calendar"],[1,"btn-secondary-light",3,"click"],["class","py-3",4,"ngIf"],["class","w-full px-12 pt-5 pb-10",4,"ngIf"],[1,"py-3"],[1,"w-full","px-12","pt-5","pb-10"],[1,"mx-auto",3,"selectedIndex"],["stepper",""],[3,"stepControl"],[3,"formGroup"],[1,"grid","grid-row-2","w-full","gap-6"],[3,"click",4,"ngIf"],[3,"click"],["type","radio","formControlName","bookOther","id","bookOther","value","bookOther",1,"hidden","peer"],["for","bookOther",1,"inline-flex","items-center","justify-between","w-full","p-5","text-gray-500","bg-white","border","border-gray-200","rounded-lg","cursor-pointer","peer-checked:border-blue-600","peer-checked:text-blue-600","hover:text-gray-600","hover:bg-gray-100"],[1,"flex","items-center","gap-3"],[1,"fa-solid","fa-people-robbery","text-[44px]"],[1,"w-full","text-lg","font-semibold"],[1,"w-full"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 14 10",1,"w-5","h-5","ml-3"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M1 5h12m0 0L9 1m4 4L9 9"],[3,"stepControl","ariaSelected"],[4,"ngIf","ngIfElse"],["loader",""],[1,"flex","gap-4"],[1,"flex","items-center","px-4","border","border-gray-200","rounded"],["checked","","id","bordered-radio-2","type","radio","value","","name","bordered-radio",1,"w-4","h-4","text-blue-600","bg-gray-100","border-gray-300","focus:ring-0",3,"click"],["for","bordered-radio-2",1,"w-full","py-2","ml-2","text-sm","font-medium","text-gray-900"],["id","bordered-radio-1","type","radio","value","","name","bordered-radio",1,"w-4","h-4","text-blue-600","bg-gray-100","border-gray-300","focus:ring-0",3,"click"],["for","bordered-radio-1",1,"w-full","py-2","ml-2","text-sm","font-medium","text-gray-900"],[1,"pt-5"],[1,"w-full",3,"formGroup"],[1,"-mx-3","flex","flex-wrap"],[1,"w-full","px-3","sm:w-1/2"],[1,"mb-5"],["for","name",1,"mb-2","block","font-medium","text-[14px]","text-[#07074D]"],["autocomplete","off","formControlName","patientName","type","text","name","patientName","id","patientName","placeholder","Full Name",1,"w-full","rounded-md","border","border-[#e0e0e0]","bg-white","py-1.5","px-3","text-base","font-normal","text-[14px]","text-[#6B7280]","outline-none","focus:border-[#6A64F1]","focus:shadow-md"],["class","text-red-600 text-sm",4,"ngIf"],["for","age",1,"mb-2","block","font-medium","text-[14px]","text-[#07074D]"],["autocomplete","off","maxlength","3","minlength","1","formControlName","age","id","age","placeholder","Age",1,"w-full","rounded-md","border","border-[#e0e0e0]","bg-white","py-1.5","px-3","text-base","font-normal","text-[14px]","text-[#6B7280]","outline-none","focus:border-[#6A64F1]","focus:shadow-md"],["for","patientMobileNo",1,"mb-2","block","font-medium","text-[14px]","text-[#07074D]"],["autocomplete","off","maxlength","11","minlength","11","formControlName","patientMobileNo","id","patientMobileNo","placeholder","Patient Mobile No",1,"w-full","rounded-md","border","border-[#e0e0e0]","bg-white","py-1.5","px-3","text-base","font-normal","text-[14px]","text-[#6B7280]","outline-none","focus:border-[#6A64F1]","focus:shadow-md"],["for","date",1,"mb-2","block","font-medium","text-[14px]","text-[#07074D]"],["formControlName","gender","name","gender","id","gender",1,"w-full","rounded-md","border","border-[#e0e0e0]","bg-white","py-2","px-3","text-base","font-normal","text-[14px]","text-[#6B7280]","outline-none","focus:border-[#6A64F1]","focus:shadow-md"],["value","0",1,"font-semibold","text-gray-500"],[3,"value",4,"ngFor","ngForOf"],["class","text-[14px] text-red-600",4,"ngIf"],["for","bloodGroup",1,"mb-2","block","font-medium","text-[14px]","text-[#07074D]"],["formControlName","bloodGroup","name","bloodGroup","id","bloodGroup",1,"w-full","rounded-md","border","border-[#e0e0e0]","bg-white","py-2","px-3","text-base","font-normal","text-[14px]","text-[#6B7280]","outline-none","focus:border-[#6A64F1]","focus:shadow-md"],["value","A+",1,"font-semibold","text-gray-500"],["value","A-",1,"font-semibold","text-gray-500"],["value","B+",1,"font-semibold","text-gray-500"],["value","B-",1,"font-semibold","text-gray-500"],["value","O+",1,"font-semibold","text-gray-500"],["value","O-",1,"font-semibold","text-gray-500"],["value","AB+",1,"font-semibold","text-gray-500"],["value","AB-",1,"font-semibold","text-gray-500"],["value","others",1,"font-semibold","text-gray-500"],[1,"flex","gap-5"],[1,"btn-secondary","py-2","mt-6",3,"click"],[1,"btn-secondary","bg-primary","py-2","mt-6",3,"click"],["class","flex items-center gap-1 tetx-white",4,"ngIf"],["class","loading loading-dots loading-md",4,"ngIf"],[3,"bookingInfo","gotToBack"],["type","radio","formControlName","bookMyself","id","bookMyself","value","bookMyself","required","",1,"hidden","peer"],["for","bookMyself",1,"inline-flex","items-center","justify-between","w-full","p-5","text-gray-500","bg-white","border","border-gray-200","rounded-lg","cursor-pointer","peer-checked:border-blue-600","peer-checked:text-blue-600","hover:text-gray-600","hover:bg-gray-100"],[1,"fa-solid","fa-person","text-[44px]"],[1,"flex","justify-between"],[1,"grid","grid-cols-5","gap-4"],[1,"col-span-1","rounded-full","w-[50px]","h-[50px]","overflow-hidden","border-secondary","border-2"],["width","50","height","50","alt","",1,"w-full","h-full","object-cover",3,"ngSrc"],[1,"col-span-4"],[1,"heading","text-[20px]"],[1,"py-0","px-3"],[1,"leading-0"],[1,"stat-title"],[1,"stat-value","text-secondary","text[24px]"],[1,"h-px","my-8","bg-gray-200","border-0"],["matInput","","formControlName","appointmentDate","placeholder","Appointment Date",1,"w-full","rounded-md","border","border-[#e0e0e0]","bg-white","py-1.5","px-3","text-base","font-normal","text-[14px]","text-[#6B7280]","outline-none","focus:border-[#6A64F1]","focus:shadow-md",3,"matDatepickerFilter","matDatepicker","max","min","click"],["picker",""],["for","doctorScheduleType",1,"mb-2","block","font-medium","text-[14px]","text-[#07074D]"],["formControlName","doctorScheduleType","name","doctorScheduleType","id","doctorScheduleType",1,"w-full","rounded-md","border","border-[#e0e0e0]","bg-white","py-2","px-3","text-base","font-normal","text-[14px]","text-[#6B7280]","outline-none","focus:border-[#6A64F1]","focus:shadow-md"],["class","font-semibold text-gray-500",3,"value",4,"ngFor","ngForOf"],["formControlName","appointmentType","name","appointmentType","id","appointmentType",1,"w-full","rounded-md","border","border-[#e0e0e0]","bg-white","py-2","px-3","text-base","font-normal","text-[14px]","text-[#6B7280]","outline-none","focus:border-[#6A64F1]","focus:shadow-md"],[1,"flex","gap-5","mt-10","w-full"],[1,"btn-secondary","py-2","bg-primary/90",3,"click"],[1,"btn-secondary","py-2",3,"click"],[1,"text-[14px]","text-red-600"],[1,"font-semibold","text-gray-500",3,"value"],[1,"font-Roboto","text-[16px]","font-semibold","text-primary/90"],[1,"mt-2"],["for","",1,"label"],[1,"form_input",3,"value","input"],["value",""],[3,"value"],[1,"text-red-600","text-sm"],[1,"flex","items-center","gap-1","tetx-white"],[1,"loading","loading-dots","loading-md"]],template:function(n,m){n&1&&p(0,rt,17,0,"div",0)(1,Pt,9,3,"div",1),n&2&&(d("ngIf",!m.doctorData.isAuthUser),s(),d("ngIf",m.doctorData.isAuthUser))},dependencies:[$,A,_e,ye,ke,fe,Se,ve,ge,he,we,Ie,De,xe,be,ue,Ve,Oe,je,Re,He,qe,Ge,pe],styles:[".mat-horizontal-stepper-header-container{display:none!important}  .mat-horizontal-content-container{padding:0!important}input[type=radio][_ngcontent-%COMP%]:checked + .radio-card[_ngcontent-%COMP%]{background:#006c93;color:#fff}"]});let o=a;return o})();export{ti as a};
