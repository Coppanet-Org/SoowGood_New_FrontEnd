import{a as _,g as A}from"./chunk-EFF4UWHC.js";import{e as y,h as C,p as w,x as T,z as E}from"./chunk-ZTTR5QA2.js";import{a as I}from"./chunk-7LPMGZKA.js";import{Ca as v,Db as k,Eb as S,Ha as u,Sa as f,X as b,Xa as i,Ya as o,ac as x,fb as g,hb as h,tb as e,vb as m,ya as l,za as p}from"./chunk-TXQBTV46.js";function D(a,s){if(a&1&&e(0),a&2){let c=h();m(" ",c.bookingInfo==null?null:c.bookingInfo.doctorChamberName," ")}}function F(a,s){a&1&&e(0," Soowgood Online Platform ")}function R(a,s){if(a&1&&(i(0,"tr",7)(1,"th",5),e(2," Booth Fee : "),o(),i(3,"td",6),e(4),o()()),a&2){let c=h();l(4),m("",c.bookingInfo==null?null:c.bookingInfo.agentFee," tk.")}}var V=(()=>{let s=class s{constructor(n,r,t,d,B,P){this.ToasterService=n,this.AppointmentService=r,this.DoctorChamberService=t,this.AuthService=d,this.sslCommerzService=B,this.ekPayService=P,this.gotToBack=new v,this.sslInputDto={applicantCode:"",examFee:100,serviceCharge:0,customAmount:10,isCustomAmount:!1},this.hasValidCode=!1,this.sslCInputDto={},this.loading=!1,this.appointmentType=A.getEnumList(_)}ngOnInit(){this.userType=this.AuthService.authInfo().userType}getTitle(n,r){if(r=="appointmentType")return this.appointmentType.find(t=>t.id==n)}createAppointmentAndPayment(){this.loading=!0;try{this.AppointmentService.create(this.bookingInfo).subscribe({next:n=>{this.payWithSslCommerz(n.appointmentCode),localStorage.setItem("patientAppointmentCode",JSON.stringify(n.appointmentCode))},error:n=>{console.log(n),this.ToasterService.customToast(String(n.error.error.message),"error"),this.loading=!1}})}catch(n){console.log(n)}}payWithSslCommerz(n){if(this.bookingInfo){let r={};r.applicationCode=n,r.totalAmount=String(this.bookingInfo.totalAppointmentFee),r.transactionId="",this.sslCommerzService.initiatePayment(r).subscribe({next:t=>{t&&t.status==="SUCCESS"&&t.gatewayPageURL?(window.location.href=t.gatewayPageURL,this.loading=!1):this.ToasterService.customToast("Unable to initiate your payment request. Please contact our support team.","error")},error:t=>{this.ToasterService.customToast(String(t.error.error.message),"error"),this.loading=!1}})}else this.ToasterService.customToast("Booking info not found","error")}};s.\u0275fac=function(r){return new(r||s)(p(E),p(y),p(C),p(I),p(T),p(w))},s.\u0275cmp=b({type:s,selectors:[["app-booking-review"]],inputs:{bookingInfo:"bookingInfo"},outputs:{gotToBack:"gotToBack"},decls:44,vars:11,consts:[[1,"w-full","my-5","p-4","bg-white","border","border-gray-200","rounded-lg","shadow","sm:p-6","m-auto","custom-scrollbar","max-h-[460px]","overflow-y-scroll"],[1,"text-base","font-semibold","text-primary","md:text-xl"],[1,"relative","overflow-x-auto"],[1,"w-full","mt-6","text-sm","text-left","text-gray-500"],[1,"bg-white","border-b"],["scope","row",1,"py-2","font-medium","text-primary","whitespace-nowrap"],[1,"py-2"],[1,"bg-white"],["class","bg-white"],["scope","row",1,"py-2","font-Roboto","font-semibold","text-[18px]","text-primary","whitespace-nowrap"],[1,"py-2","font-Roboto","font-semibold","text-[18px]","text-primary"],[1,"flex","gap-5"],[1,"btn-secondary","bg-primary","mt-6","text-[15px]","tracking-[1px]","py-1","w-full",3,"click"],[1,"btn-secondary","mt-6","text-[16px]","tracking-[1px]","py-2","w-full",3,"click"]],template:function(r,t){r&1&&(i(0,"div",0)(1,"h5",1),e(2),o(),i(3,"div",2)(4,"table",3)(5,"tbody")(6,"tr",4)(7,"th",5),e(8," Patient name: "),o(),i(9,"td",6),e(10),o()(),i(11,"tr",4)(12,"th",5),e(13," Appointment Date : "),o(),i(14,"td",6),e(15),k(16,"date"),o()(),i(17,"tr",4)(18,"th",5),e(19," Hospital name : "),o(),i(20,"td",6),u(21,D,1,1)(22,F,1,0),o()(),i(23,"tr",7)(24,"th",5),e(25," Doctor Fee : "),o(),i(26,"td",6),e(27),o()(),u(28,R,5,1,"tr",8),i(29,"tr",7)(30,"th",5),e(31," Platform Fee : "),o(),i(32,"td",6),e(33),o()(),i(34,"tr",7)(35,"th",9),e(36," Total Fee : "),o(),i(37,"td",10),e(38),o()()()(),i(39,"div",11)(40,"button",12),g("click",function(){return t.gotToBack.emit(1)}),e(41," Back "),o(),i(42,"button",13),g("click",function(){return t.createAppointmentAndPayment()}),e(43),o()()()()),r&2&&(l(2),m(" ",t.bookingInfo==null?null:t.bookingInfo.doctorName," "),l(8),m(" ",t.bookingInfo==null?null:t.bookingInfo.patientName," "),l(5),m(" ",S(16,9,t.bookingInfo==null?null:t.bookingInfo.appointmentDate)," "),l(6),f(21,t.bookingInfo!=null&&t.bookingInfo.doctorChamberName?21:22),l(6),m("",t.bookingInfo==null?null:t.bookingInfo.doctorFee," tk."),l(),f(28,t.userType!=="patient"?28:-1),l(5),m("",t.bookingInfo==null?null:t.bookingInfo.platformFee," tk."),l(5),m(" ",t.bookingInfo==null?null:t.bookingInfo.totalAppointmentFee," tk. "),l(5),m(" ",t.loading?"Loading...":"Confirm & Pay"," "))},dependencies:[x]});let a=s;return a})();export{V as a};
