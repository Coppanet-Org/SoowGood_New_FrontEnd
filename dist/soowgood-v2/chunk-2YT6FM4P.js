import{a as Xe}from"./chunk-6UWMS6O7.js";import{d as Je,e as Ke}from"./chunk-MELX6YOY.js";import{a as $e}from"./chunk-RPDKASJ7.js";import{a as Ue,b as We}from"./chunk-7LZRNLM6.js";import{b as qe}from"./chunk-HT3LM57F.js";import{a as He}from"./chunk-7NGZH4SF.js";import{a as Ye,b as ze}from"./chunk-FQWPYGQS.js";import{j as Qe}from"./chunk-6KAU5MPM.js";import{a as Ge,d as Re,g as z}from"./chunk-EFF4UWHC.js";import{a as Be,b as Le}from"./chunk-XTINLLUJ.js";import{e as Ae,q as Ve,s as Oe,z as je}from"./chunk-HL5HGHA3.js";import{a as Me}from"./chunk-7LPMGZKA.js";import{A as Pe,C as Ne,c as xe,e as b,h as be,i as Se,n as ye,p as ke,r as we,u as Ce,v as De,w as Ie,x as Ee,y as Fe,z as Te}from"./chunk-FSNV7SJ3.js";import{$a as pe,Gb as fe,Ha as g,K as j,L as ne,Ma as d,R as re,Sa as le,Ta as se,Va as de,Vb as ge,Wa as me,Wb as he,X as A,Xa as i,Ya as t,Za as h,_a as ce,aa as k,ba as w,bb as B,ca as Q,d as ee,da as ae,e as $,fb as C,fc as _e,hb as _,i as te,m as q,pb as G,qb as R,rb as U,sb as W,tb as r,ub as Y,v as ie,vb as F,vc as ve,wb as ue,ya as s,z as oe,za as I}from"./chunk-TXQBTV46.js";import{a as X,b as Z}from"./chunk-5G567QLT.js";var V=(()=>{let a=class a{constructor(){this.doctorSlotList=new $([]),this.doctorScheduleList=new $([]),this.selectedSlot=new ee}sendDoctorAvailableSlotData(e){this.doctorSlotList.next(e)}getDoctorAvailableSlotData(){return this.doctorSlotList.asObservable()}sendDoctorScheduleData(e){this.doctorScheduleList.next(e)}getDoctorScheduleData(){return this.doctorScheduleList.asObservable()}sendSelectedSlot(e){this.selectedSlot.next(e)}getSelectedSlot(){return this.selectedSlot.asObservable()}};a.\u0275fac=function(n){return new(n||a)},a.\u0275prov=re({token:a,factory:a.\u0275fac,providedIn:"root"});let o=a;return o})();function nt(o,a){if(o&1){let l=B();i(0,"div",1),h(1,"input",2),i(2,"label",3),C("click",function(){k(l);let n=_();return w(n.selectSlot(n.item))}),i(3,"div",4),h(4,"span",5),i(5,"div",6)(6,"p",7),r(7),t()(),i(8,"p",7),r(9),t()()()()}if(o&2){let l=_();s(),d("id",l.item.id)("value",l.item.id),s(),d("for",l.item.id),s(5),ue(" ",l.formatTime(l.item.startTime)," - ",l.formatTime(l.item.endTime)," "),s(2),F("(",l.item.leftSlot," slot available)")}}function rt(o,a){o&1&&(i(0,"p",8),r(1,` No slot available for your selected date/hospital/chamber. Please change your selection!
`),t())}var Ze=(()=>{let a=class a{constructor(e){this.DoctorScheduleStateService=e}selectSlot(e){this.DoctorScheduleStateService.sendSelectedSlot(e)}formatTime(e){return new Date(`1970-01-01T${e}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})}};a.\u0275fac=function(n){return new(n||a)(I(V))},a.\u0275cmp=A({type:a,selectors:[["app-slot-item"]],inputs:{item:"item"},decls:2,vars:1,consts:[["class","flex items-center"],[1,"flex","items-center"],["hidden","","type","radio","name","default-radio",1,"w-4","h-4","text-blue-600","bg-gray-100","border-gray-300","focus:ring-blue-500","focus:ring-2",3,"id","value"],[1,"radio-card","flex","py-2","px-3","border-[1px]","border-secondary-dark/20","bg-secondary-light","text-secondary-dark","cursor-pointer",3,"for","click"],[1,"card-content-wrapper"],[1,"check-icon"],[1,"card-content","tooltip"],[1,"text-[14px]"],[1,"absolute","top-0","text-red-500"]],template:function(n,m){n&1&&g(0,nt,10,6,"div",0)(1,rt,2,0),n&2&&le(0,m.item.leftSlot>0?0:1)},styles:["input[type=radio][_ngcontent-%COMP%]:checked + .radio-card[_ngcontent-%COMP%]{background:#006c93;color:#fff}"]});let o=a;return o})();function lt(o,a){if(o&1&&h(0,"app-slot-item",1),o&2){let l=a.$implicit;d("item",l)}}var et=(()=>{let a=class a{constructor(e){this.DoctorScheduleStateService=e,this.slotList=[],this.DoctorScheduleStateService.getDoctorAvailableSlotData().pipe(ie(n=>n)).subscribe(n=>{console.log(n),this.slotList=n})}};a.\u0275fac=function(n){return new(n||a)(I(V))},a.\u0275cmp=A({type:a,selectors:[["app-slots"]],decls:3,vars:0,consts:[[1,"grid","grid-cols-3","gap-3","relative"],[3,"item"]],template:function(n,m){n&1&&(i(0,"div",0),de(1,lt,1,1,"app-slot-item",1,se),t()),n&2&&(s(),me(m.slotList))},dependencies:[Ze]});let o=a;return o})();var dt=["buttonMyself"],mt=["buttonOthers"];function ct(o,a){if(o&1){let l=B();i(0,"div",2)(1,"div",3),h(2,"img",4),i(3,"h1",5),r(4,"Welcome to Soowgood."),t()(),i(5,"div",6)(6,"p"),r(7," You must be "),i(8,"a",7),C("click",function(){k(l);let n=_();return w(n.dialogRef.close())}),r(9,"Login! "),t(),r(10," to continue! "),t(),i(11,"p"),r(12,"or"),t(),i(13,"p")(14,"a",8),C("click",function(){k(l);let n=_();return w(n.dialogRef.close())}),r(15,"Register"),t(),r(16," a new account. "),t()()()}}function pt(o,a){o&1&&(i(0,"div",15),r(1,"Loading..."),t())}function ut(o,a){if(o&1){let l=B();i(0,"li",23),C("click",function(){k(l);let n=_(3);return w(n.onStepChange(1))}),h(1,"input",75),i(2,"label",76)(3,"div",26),h(4,"i",77),i(5,"div")(6,"div",28),r(7," Book for Self "),t(),i(8,"div",29),r(9,"If you are patient!"),t()()(),Q(),i(10,"svg",30),h(11,"path",31),t()()()}}function ft(o,a){o&1&&(i(0,"p",98),r(1," Please select appointment date. "),t())}function gt(o,a){if(o&1&&(i(0,"option",99),r(1),t()),o&2){let l=a.$implicit;d("value",l.id),s(),F(" ",l.name," ")}}function ht(o,a){o&1&&(i(0,"p",98),r(1," Please select a hospital/chamber "),t())}function _t(o,a){if(o&1&&(i(0,"option",99),r(1),t()),o&2){let l=a.$implicit;d("value",l.id),s(),F(" ",l.name," ")}}function vt(o,a){o&1&&(i(0,"p",98),r(1," Please select appointment type "),t())}function xt(o,a){o&1&&(i(0,"div",15)(1,"label",100),r(2," Available Slots : "),t(),i(3,"div",101),h(4,"app-slots"),t()())}function bt(o,a){if(o&1&&(i(0,"div",15)(1,"p"),r(2),t()()),o&2){let l=_(4);s(2),Y(l.showEmptySlot)}}function St(o,a){if(o&1){let l=B();i(0,"div")(1,"form",20)(2,"div",78)(3,"div",79)(4,"div",80),h(5,"img",81),t(),i(6,"div",82)(7,"h2",83),r(8),t(),i(9,"p"),r(10),t()()(),i(11,"div",84)(12,"div",85)(13,"div",86),r(14,"Total Fee"),t(),i(15,"div",87),r(16),t()()()(),h(17,"hr",88),i(18,"div",43)(19,"div",44)(20,"div",45)(21,"label",53),r(22," Appointment Date "),t(),i(23,"input",89),C("click",function(){k(l);let n=W(25);return w(n.open())}),t(),h(24,"mat-datepicker",null,90),g(26,ft,2,0,"p",57),t()(),i(27,"div",44)(28,"div",45)(29,"label",91),r(30," Select place "),t(),i(31,"select",92)(32,"option",55),r(33," Select hospital/chamber "),t(),g(34,gt,2,2,"option",93),t(),g(35,ht,2,0,"p",57),t()(),i(36,"div",44)(37,"div",45)(38,"label",53),r(39," Select appointment type "),t(),i(40,"select",94)(41,"option",55),r(42," Select appointment type "),t(),g(43,_t,2,2,"option",93),t(),g(44,vt,2,0,"p",57),t()()()(),g(45,xt,5,0,"div",13)(46,bt,3,1,"div",13),i(47,"div",95)(48,"button",96),C("click",function(){k(l);let n=_(3);return w(n.onStepChange(0))}),r(49," Back "),t(),i(50,"button",97),C("click",function(){k(l);let n=_(3);return w(n.onStepChange(3))}),r(51),t()()()}if(o&2){let l=W(25),e=_(3),n,m,S;s(),d("formGroup",e.form),s(4),d("ngSrc",(e.doctorData.doctorDetails==null?null:e.doctorData.doctorDetails.picUrl)||"/doctor/dr.jpeg"),s(3),F(" ",e.doctorData==null?null:e.doctorData.doctorDetails.fullName," "),s(2),Y(e.doctorData==null?null:e.doctorData.doctorDetails.areaOfExperties),s(6),F(" ",e.totalFee?e.totalFee:"00",".0 tk. "),s(7),d("matDatepickerFilter",e.dateFilter)("matDatepicker",l)("max",e.maxDate)("min",e.minDate)("matDatepicker",l),s(3),d("ngIf",e.formSubmitted&&((n=e.form.get("appointmentDate"))==null?null:n.hasError("required"))),s(8),d("ngForOf",e.hospitalList),s(),d("ngIf",e.formSubmitted&&((m=e.form.get("doctorScheduleType"))==null?null:m.value)==="0"),s(8),d("ngForOf",e.appointmentType),s(),d("ngIf",e.formSubmitted&&((S=e.form.get("appointmentType"))==null?null:S.value)==="0"),s(),d("ngIf",(e.filterData==null?null:e.filterData.length)>0),s(),d("ngIf",(e.filterData==null?null:e.filterData.length)<=0&&e.showEmptySlot!==""),s(5),F(" ",e.isLoading?"Loading...":"Next"," ")}}function yt(o,a){o&1&&r(0," Data is loading... ")}function kt(o,a){if(o&1&&(i(0,"option",105),r(1),t()),o&2){let l=a.$implicit;d("value",l.id),s(),F(" ",l.name," ")}}function wt(o,a){if(o&1){let l=B();i(0,"div")(1,"label",102),r(2,"Select your patient"),t(),ce(3),i(4,"select",103),C("input",function(n){k(l);let m=_(3);return w(m.getSinglePatientData(n))}),i(5,"option",104),r(6,"--Select Patient--"),t(),g(7,kt,2,2,"option",56),t(),pe(),t()}if(o&2){let l=_(3);s(4),d("value",l.value),s(3),d("ngForOf",l.userPatientList)}}function Ct(o,a){o&1&&(i(0,"p",106),r(1," Please enter patient name. "),t())}function Dt(o,a){o&1&&(i(0,"p",106),r(1," Patient name should contain only letters and numbers at the end (optional). "),t())}function It(o,a){o&1&&(i(0,"p",106),r(1," Patient name should be at least 3 characters long "),t())}function Et(o,a){o&1&&(i(0,"p",106),r(1," Please enter patient age. "),t())}function Ft(o,a){o&1&&(i(0,"p",106),r(1," Age should be a number. "),t())}function Tt(o,a){o&1&&(i(0,"p",106),r(1," You must enter a valid mobile number! "),t())}function Pt(o,a){o&1&&(i(0,"p",106),r(1," Mobile number should have exactly 11 digits and follow the Bangladeshi format! "),t())}function Nt(o,a){if(o&1&&(i(0,"option",105),r(1),t()),o&2){let l=a.$implicit;d("value",l.id),s(),F(" ",l.name," ")}}function Bt(o,a){o&1&&(i(0,"p",98),r(1," Please select gender! "),t())}function Lt(o,a){o&1&&(i(0,"p",98),r(1," Please select blood group! "),t())}function Mt(o,a){o&1&&(i(0,"div",107)(1,"span"),r(2,"Continue"),t()())}function At(o,a){o&1&&h(0,"span",108)}function Vt(o,a){if(o&1){let l=B();i(0,"div",16)(1,"mat-stepper",17,18)(3,"mat-step",19)(4,"form",20)(5,"ul",21),g(6,ut,12,0,"li",22),i(7,"li",23),C("click",function(){k(l);let n=_(2);return w(n.onStepChange(2))}),h(8,"input",24),i(9,"label",25)(10,"div",26),h(11,"i",27),i(12,"div")(13,"div",28),r(14,"Book Someone"),t(),i(15,"div",29),r(16,"If someone is patient!"),t()()(),Q(),i(17,"svg",30),h(18,"path",31),t()()()()()(),ae(),i(19,"mat-step",32),g(20,St,52,18,"div",33)(21,yt,1,0,"ng-template",null,34,fe),t(),i(23,"mat-step",19)(24,"div",35)(25,"div",36)(26,"input",37),C("click",function(){k(l);let n=_(2);return w(n.userExistCheck("exist-user"))}),t(),i(27,"label",38),r(28," Already Exist "),t()(),i(29,"div",36)(30,"input",39),C("click",function(){k(l);let n=_(2);return w(n.userExistCheck("new-user"))}),t(),i(31,"label",40),r(32," New Patient "),t()()(),i(33,"div",41),g(34,wt,8,2,"div",1),i(35,"div",41)(36,"form",42)(37,"div",43)(38,"div",44)(39,"div",45)(40,"label",46),r(41," Full Name "),t(),h(42,"input",47),g(43,Ct,2,0,"p",48)(44,Dt,2,0,"p",48)(45,It,2,0,"p",48),t()(),i(46,"div",44)(47,"div",45)(48,"label",49),r(49," Age "),t(),h(50,"input",50),g(51,Et,2,0,"p",48)(52,Ft,2,0,"p",48),t()(),i(53,"div",44)(54,"div",45)(55,"label",51),r(56," Patient Mobile No "),t(),h(57,"input",52),g(58,Tt,2,0,"p",48)(59,Pt,2,0,"p",48),t()(),i(60,"div",44)(61,"div",45)(62,"label",53),r(63," Select gender "),t(),i(64,"select",54)(65,"option",55),r(66," Select gender "),t(),g(67,Nt,2,2,"option",56),t(),g(68,Bt,2,0,"p",57),t()(),i(69,"div",44)(70,"div",45)(71,"label",58),r(72," Select blood group "),t(),i(73,"select",59)(74,"option",55),r(75," Select blood group "),t(),i(76,"option",60),r(77," A+ "),t(),i(78,"option",61),r(79," A- "),t(),i(80,"option",62),r(81," B+ "),t(),i(82,"option",63),r(83," B- "),t(),i(84,"option",64),r(85," O+ "),t(),i(86,"option",65),r(87," O- "),t(),i(88,"option",66),r(89," AB+ "),t(),i(90,"option",67),r(91," AB- "),t(),i(92,"option",68),r(93," others "),t()(),g(94,Lt,2,0,"p",57),t()()()()()(),i(95,"div",69)(96,"button",70),C("click",function(){k(l);let n=_(2);return w(n.onStepChange(0))}),r(97," Back "),t(),i(98,"button",71),C("click",function(){k(l);let n=_(2);return w(n.createNewPatient())}),g(99,Mt,3,0,"div",72)(100,At,1,0,"span",73),t()()(),i(101,"mat-step",19)(102,"app-booking-review",74),C("gotToBack",function(n){k(l);let m=_(2);return w(m.onStepChange(n))}),t()()()()}if(o&2){let l=W(22),e=_(2),n,m,S,T,P,L,M,D,v;s(),d("selectedIndex",e.activeTab),s(2),d("stepControl",e.firstFormGroup),s(),d("formGroup",e.bookingForm),s(2),d("ngIf",e.sessionRole=="patient"),s(13),d("stepControl",e.secondFormGroup)("ariaSelected",e.activeTab),s(),d("ngIf",!e.dataLoader)("ngIfElse",l),s(3),d("stepControl",e.thirdFormGroup),s(11),d("ngIf",e.isExistUser),s(2),d("formGroup",e.createPatientForm),s(7),d("ngIf",e.formSubmitted&&((n=e.createPatientForm.get("patientName"))==null?null:n.hasError("required"))),s(),d("ngIf",e.formSubmitted&&((m=e.createPatientForm.get("patientName"))==null?null:m.hasError("pattern"))),s(),d("ngIf",e.formSubmitted&&((S=e.createPatientForm.get("patientName"))==null?null:S.hasError("invalidName"))),s(6),d("ngIf",e.formSubmitted&&((T=e.createPatientForm.get("age"))==null?null:T.hasError("required"))),s(),d("ngIf",e.formSubmitted&&((P=e.createPatientForm.get("age"))==null?null:P.hasError("pattern"))),s(6),d("ngIf",e.formSubmitted&&((L=e.createPatientForm.get("patientMobileNo"))==null?null:L.hasError("required"))),s(),d("ngIf",e.formSubmitted&&((M=e.createPatientForm.get("patientMobileNo"))==null?null:M.hasError("pattern"))),s(8),d("ngForOf",e.genderList),s(),d("ngIf",e.formSubmitted&&(((D=e.createPatientForm.get("gender"))==null?null:D.value)==="0"||((D=e.createPatientForm.get("gender"))==null?null:D.value)==null)),s(26),d("ngIf",e.formSubmitted&&(((v=e.createPatientForm.get("bloodGroup"))==null?null:v.value)==="0"||((v=e.createPatientForm.get("bloodGroup"))==null?null:v.value)===null)),s(5),d("ngIf",e.btnLoader==!1),s(),d("ngIf",e.btnLoader==!0),s(),d("stepControl",e.fourFormGroup),s(),d("bookingInfo",e.bookingInfo)}}function Ot(o,a){if(o&1){let l=B();i(0,"div")(1,"div",9)(2,"h1",10),h(3,"i",11),r(4),t(),i(5,"button",12),C("click",function(){k(l);let n=_();return w(n.closeDialogs())}),r(6,"Close"),t()(),g(7,pt,2,0,"div",13)(8,Vt,103,25,"div",14),t()}if(o&2){let l=_();s(4),F(" Booking ",l.stepHeading," "),s(3),d("ngIf",l.dataLoader),s(),d("ngIf",!l.dataLoader)}}var di=(()=>{let a=class a{constructor(e,n,m,S,T,P,L,M,D,v){this.fb=e,this.UserinfoStateService=n,this.PatientProfileService=m,this.FinancialSetupService=S,this.TosterService=T,this.DoctorScheduleStateService=P,this.NormalAuth=L,this.dialogRef=M,this.AppointmentService=D,this.doctorData=v,this.isBookMyselfClick=!1,this.isBookOther=!1,this.isNewUser=!1,this.isExistUser=!0,this.btnLoader=!1,this.userPatientList=[],this.serviceFeeList=[],this.showAppointmentTypeSelectBox=!0,this.stepHeading="",this.dataLoader=!1,this.hasValidCode=!1,this.createNewPatientInfo={},this.alreadyExistPatient={},this.disabledDays=[],this.subs=new He,this.formSubmitted=!1,this.showEmptySlot="",this.filteredChamber=[],this.isLoading=!1,this.dateFilter=N=>{if(!N)return!1;let O=N.getDay();return!this.disabledDays.includes(O)},this.inputForCreatePatient=Je,this.firstFormGroup=this.fb.group({firstCtrl:["",b.required]}),this.secondFormGroup=this.fb.group({secondCtrl:["",b.required]});let y=new Date,c=y.getFullYear(),x=y.getMonth(),p=y.getDate();this.minDate=new Date(c,x,p);let u=new Date(y);u.setDate(y.getDate()+30),this.maxDate=u}ngOnInit(){this.dataLoader=!0,this.sessionRole=this.NormalAuth.authInfo()?.userType,this.selectedSlotInfo="",this.appointmentType=z.getEnumList(Ge),this.genderList=z.getEnumList(Re),this.FinancialSetupService.getList().subscribe(c=>{this.serviceFeeList=c}),this.DoctorScheduleStateService.getSelectedSlot().pipe().subscribe(c=>{this.selectedSlotInfo=c});let e=this.doctorData.doctorScheduleInfo,n=this.NormalAuth.authInfo()?.id;n&&(this.sessionRole=="patient"&&this.UserinfoStateService.getUserPatientInfo(n,"patient"),this.sessionRole=="agent"&&this.UserinfoStateService.getUserPatientInfo(n,"agent"),this.UserinfoStateService.getData().pipe(ne(c=>(this.profileInfo=c,this.loadForm(),this.dataLoader=!1,c?this.UserinfoStateService.getUserPatientData().pipe(q(x=>x?.map(p=>({name:p.patientName,id:p.id})))):te([])))).subscribe(c=>{this.userPatientList=c}));let m=this.form.get("appointmentDate")?.valueChanges.pipe(j(this.form.get("appointmentDate")?.value)),S=this.form.get("doctorScheduleType")?.valueChanges.pipe(j(this.form.get("doctorScheduleType"))),T=this.form.get("appointmentType")?.valueChanges.pipe(j(this.form.get("appointmentType")?.value)),P=e.map(c=>c.doctorScheduleDaySession.map(x=>x.scheduleDayofWeek)).flat(),L=c=>["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].indexOf(c),M=[0,1,2,3,4,5,6],D=[...new Set(P)].map(L);this.disabledDays=M.filter(c=>!D.includes(c));let v="",y="";m.pipe(q(c=>(v=Ke(String(c)),y=c,console.log(y),e.filter(p=>p.doctorScheduleDaySession.some(u=>u.scheduleDayofWeek===v)).map(p=>({name:p.scheduleName,id:p.id}))))).subscribe(c=>{this.hospitalList=c}),S.pipe(q(c=>{let x=e.find(u=>u.scheduleName===c)?.doctorScheduleDaySession.filter(u=>u.scheduleDayofWeek===v),p=e.find(u=>u.scheduleName===c);return{sessions:x,updatedSchedule:p}})).subscribe(({sessions:c,updatedSchedule:x})=>{let p=c?.map(u=>{let N=x?.appointments?.filter(O=>O.doctorScheduleDaySessionId==u.id)?.length;return Z(X({},u),{leftSlot:u.noOfPatients-N})});this.filterData=p,this.DoctorScheduleStateService.sendDoctorAvailableSlotData(p)}),S.pipe(oe(T)).subscribe(c=>{if(c[1]==0){this.totalFee=0;return}let x=e.filter(p=>p.scheduleName===c[0]);x?x.map(p=>{console.log(p);let u=p.doctorFeesSetup.find(N=>N.appointmentType==c[1]?N.totalFee:"");if(!u){this.TosterService.customToast("Fee not found your selected appointment type!","warning"),this.totalFee=0;return}this.totalFee=u?.totalFee,this.selectedFeesInfo=u}):this.TosterService.customToast("Fee not found your selected appointment type!","warning")})}isDayAvailable(e,n){return e.filter(m=>m.scheduleDayofWeek===n)}loadForm(){this.bookingForm=this.fb.group({bookMyself:[""],bookOther:[""],patientName:["",b.required],age:["",b.required],mobile:["",b.required]}),this.form=this.fb.group({consultancyType:[""],doctorScheduleType:["0",b.required],appointmentDate:["",b.required],appointmentType:["0",b.required]}),this.createPatientForm=this.fb.group({isSelf:[!1,b.required],patientName:["",b.required],patientProfileId:[""],age:["",[b.required,b.pattern(/^[1-9][0-9]{0,2}$/)]],gender:["0",b.required],bloodGroup:["0",b.required],patientMobileNo:["",[b.required,b.pattern(/^(?:88)?[0-9]{11}$/)]],patientEmail:[this.profileInfo?.email||"admin@gmail.com",b.required],createdBy:[this.profileInfo.fullName,b.required],creatorEntityId:[this.profileInfo.id,b.required],creatorRole:[this.sessionRole=="patient"?"patient":"agent",b.required]})}onStepChange(e){e>=0&&e<3&&(this.activeTab=e),console.log(e);let{appointmentType:n,appointmentDate:m,doctorScheduleType:S}=this.form.value,T=n!=0&&S!=0&&m;if(e===3&&T){if(this.isLoading=!0,this.formSubmitted=!0,this.filterData.length<=0&&!this.selectedSlotInfo?.doctorScheduleId){this.TosterService.customToast("No slot found your selected options!","warning");return}let{doctorScheduleId:P,id:L,scheduleDayofWeek:M}=this.selectedSlotInfo,D=this.doctorData.doctorScheduleInfo.find(v=>v.id===P);if(D&&D.consultancyType){let v="",y="",c=0,x=0,p=0,u=0;this.sessionRole=="agent"&&(D.consultancyType==1?(y=this.serviceFeeList.find(f=>f.platformFacilityId==4)?.externalAmountIn,x=this.serviceFeeList.find(f=>f.platformFacilityId==4&&f.externalAmountIn==y)?.externalAmount,y=="Percentage"?u=this.selectedFeesInfo.totalFee*(x/100):y=="Flat"&&(u=x)):D.consultancyType==2&&(y=this.serviceFeeList.find(f=>f.platformFacilityId==5)?.externalAmountIn,x=this.serviceFeeList.find(f=>f.platformFacilityId==5&&f.externalAmountIn==y)?.externalAmount,y=="Percentage"?u=this.selectedFeesInfo.totalFee*(x/100):y=="Flat"&&(u=x))),D.consultancyType==1?(v=this.serviceFeeList.find(f=>f.platformFacilityId==1)?.amountIn,c=this.serviceFeeList.find(f=>f.platformFacilityId==1&&f.amountIn==v)?.amount,v=="Percentage"?p=this.selectedFeesInfo.totalFee*(c/100):v=="Flat"&&(p=c)):D.consultancyType==2&&(v=this.serviceFeeList.find(f=>f.platformFacilityId==2)?.amountIn,c=this.serviceFeeList.find(f=>f.platformFacilityId==2&&f.amountIn==v)?.amount,v=="Percentage"?p=this.selectedFeesInfo.totalFee*(c/100):v=="Flat"&&(p=c)),this.formSubmitted=!0;let{consultancyType:N,doctorChamberId:O,doctorProfileId:tt,scheduleType:it,chamber:ot}=D,E="";this.UserinfoStateService.getData().subscribe(f=>E=f);let K={doctorScheduleId:P,doctorProfileId:tt,doctorName:this.doctorData?.doctorDetails.fullName,doctorCode:this.doctorData?.doctorDetails.doctorCode,patientProfileId:this.alreadyExistPatient?.id?this.alreadyExistPatient?.id:this.createNewPatientInfo.id?this.createNewPatientInfo?.id:E?.id,patientName:this.alreadyExistPatient?.patientName?this.alreadyExistPatient?.patientName:this.createNewPatientInfo?.patientName?this.createNewPatientInfo?.patientName:E?.fullName,patientCode:this.alreadyExistPatient?.patientCode?this.alreadyExistPatient?.patientCode:this.createNewPatientInfo?.patientCode?this.createNewPatientInfo?.patientCode:E?.patientCode,patientMobileNo:this.alreadyExistPatient?.patientMobileNo?this.alreadyExistPatient?.patientMobileNo:this.createNewPatientInfo?.patientMobileNo?this.createNewPatientInfo?.patientMobileNo:E?.mobileNo,patientEmail:this.alreadyExistPatient?.patientEmail?this.alreadyExistPatient?.patientEmail:this.createNewPatientInfo?.patientEmail?this.createNewPatientInfo?.patientEmail:E.email||"admin@gmail.com",consultancyType:N,doctorChamberId:O,doctorChamberName:ot,scheduleType:it,doctorScheduleDaySessionId:L,scheduleDayofWeek:M,appointmentType:n,appointmentDate:m,appointmentTime:"",doctorFeesSetupId:this.selectedFeesInfo.id,doctorFee:this.selectedFeesInfo.totalFee,agentFee:u,platformFee:p,totalAppointmentFee:this.selectedFeesInfo.totalFee+p+u,appointmentStatus:1,appointmentPaymentStatus:2,appointmentCreatorId:E?.id,appointmentCreatorRole:this.sessionRole=="patient"?"patient":"agent"};if(K&&E){if(this.bookingInfo=K,this.formSubmitted=!0,this.bookingForm.get("bookMyself")?.value=="bookMyself"){let f={id:E?.id,patientName:E.fullName,patientCode:E.patientCode,patientEmail:E.email?E.email:"admin@gmail.com",patientMobileNo:E.mobileNo};this.PatientProfileService.update(f).subscribe(qt=>{this.activeTab=e,this.isLoading=!1})}this.bookingForm.get("bookOther")?.value=="bookOther"&&(this.activeTab=e,this.isLoading=!1);return}}else this.formSubmitted=!0,this.TosterService.customToast("Please select a slot","warning"),this.isLoading=!1}else this.isLoading=!1;e===3&&!T&&(this.formSubmitted=!0,this.TosterService.customToast("Please select all the required fields","warning"),this.isLoading=!1)}userExistCheck(e){switch(this.createPatientForm.get("patientName")?.reset(),this.createPatientForm.get("age")?.reset(),this.createPatientForm.get("gender")?.reset(),this.createPatientForm.get("bloodGroup")?.reset(),this.createPatientForm.get("patientMobileNo")?.reset(),e){case"new-user":this.isNewUser=!0,this.isExistUser=!1;return;case"exist-user":this.isNewUser=!1,this.isExistUser=!0;return;default:break}}createNewPatient(){if(this.formSubmitted=!0,!this.createPatientForm.valid){this.TosterService.customToast("Please field all the required fields","warning");return}if(this.isNewUser)try{this.btnLoader=!0,this.PatientProfileService.create(this.createPatientForm.value).subscribe(e=>{e.patientCode&&e.patientMobileNo&&this.PatientProfileService.getByPhoneAndCode(e.patientCode,e.patientMobileNo).subscribe(n=>{this.createNewPatientInfo=n}),this.btnLoader=!1,this.TosterService.customToast("Your patient is created!","success"),this.UserinfoStateService.getUserPatientInfo(this.profileInfo.id,"patient"),this.onStepChange(1)})}catch{this.TosterService.customToast("Something wrong! Please retry","error")}else this.onStepChange(1)}getSinglePatientData(e){e.target.value&&this.UserinfoStateService.getUserPatientData().subscribe(n=>n.find(m=>{m.id==e.target.value&&(this.alreadyExistPatient=m,this.createPatientForm.patchValue({patientProfileId:m.id,age:m.age,gender:m.gender,bloodGroup:m.bloodGroup,patientMobileNo:m.patientMobileNo,patientEmail:m.patientEmail,patientName:m.patientName,createdBy:m.createdBy,creatorEntityId:m.creatorEntityId,creatorRole:m.creatorRole}))}))}closeDialogs(){this.selectedSlotInfo="",this.dialogRef.close(!1)}};a.\u0275fac=function(n){return new(n||a)(I(Ne),I(qe),I(Oe),I(Ve),I(je),I(V),I(Me),I(Be),I(Ae),I(Le))},a.\u0275cmp=A({type:a,selectors:[["app-booking-dialog"]],viewQuery:function(n,m){if(n&1&&(G(dt,5),G(mt,5),G(Xe,5)),n&2){let S;R(S=U())&&(m.buttonMyself=S.first),R(S=U())&&(m.buttonOthers=S.first),R(S=U())&&(m.customInputs=S)}},decls:2,vars:2,consts:[["class","bg-white h-[300px]",4,"ngIf"],[4,"ngIf"],[1,"bg-white","h-[300px]"],[1,"bg-primary","h-[100px]","w-full","flex","flex-col","justify-center","items-center"],["ngSrc","assets/logo.svg","alt","logo","width","50","height","50"],[1,"text-white","text-[24px]","font-roboto"],[1,"p-8","flex","justify-center","items-center","flex-col"],["routerLink","/login",1,"text-blue-500","font-bold",3,"click"],["routerLink","/signup",1,"text-blue-500","font-bold",3,"click"],[1,"flex","justify-between","py-4","px-6","border-b-[1px]","items-center"],[1,"dashbord-heading-text"],[1,"mr-1","text-[18px]","fa-solid","fa-calendar"],[1,"btn-secondary-light",3,"click"],["class","py-3",4,"ngIf"],["class","w-full px-12 pt-5 pb-10",4,"ngIf"],[1,"py-3"],[1,"w-full","px-12","pt-5","pb-10"],[1,"mx-auto",3,"selectedIndex"],["stepper",""],[3,"stepControl"],[3,"formGroup"],[1,"grid","grid-row-2","w-full","gap-6"],[3,"click",4,"ngIf"],[3,"click"],["type","radio","formControlName","bookOther","id","bookOther","value","bookOther",1,"hidden","peer"],["for","bookOther",1,"inline-flex","items-center","justify-between","w-full","p-5","text-gray-500","bg-white","border","border-gray-200","rounded-lg","cursor-pointer","peer-checked:border-blue-600","peer-checked:text-blue-600","hover:text-gray-600","hover:bg-gray-100"],[1,"flex","items-center","gap-3"],[1,"fa-solid","fa-people-robbery","text-[44px]"],[1,"w-full","text-lg","font-semibold"],[1,"w-full"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 14 10",1,"w-5","h-5","ml-3"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M1 5h12m0 0L9 1m4 4L9 9"],[3,"stepControl","ariaSelected"],[4,"ngIf","ngIfElse"],["loader",""],[1,"flex","gap-4"],[1,"flex","items-center","px-4","border","border-gray-200","rounded"],["checked","","id","bordered-radio-2","type","radio","value","","name","bordered-radio",1,"w-4","h-4","text-blue-600","bg-gray-100","border-gray-300","focus:ring-0",3,"click"],["for","bordered-radio-2",1,"w-full","py-2","ml-2","text-sm","font-medium","text-gray-900"],["id","bordered-radio-1","type","radio","value","","name","bordered-radio",1,"w-4","h-4","text-blue-600","bg-gray-100","border-gray-300","focus:ring-0",3,"click"],["for","bordered-radio-1",1,"w-full","py-2","ml-2","text-sm","font-medium","text-gray-900"],[1,"pt-5"],[1,"w-full",3,"formGroup"],[1,"-mx-3","flex","flex-wrap"],[1,"w-full","px-3","sm:w-1/2"],[1,"mb-5"],["for","name",1,"mb-2","block","font-medium","text-[14px]","text-[#07074D]"],["autocomplete","off","formControlName","patientName","type","text","name","patientName","id","patientName","placeholder","Full Name",1,"w-full","rounded-md","border","border-[#e0e0e0]","bg-white","py-1.5","px-3","text-base","font-normal","text-[14px]","text-[#6B7280]","outline-none","focus:border-[#6A64F1]","focus:shadow-md"],["class","text-red-600 text-sm",4,"ngIf"],["for","age",1,"mb-2","block","font-medium","text-[14px]","text-[#07074D]"],["autocomplete","off","maxlength","3","minlength","1","formControlName","age","id","age","placeholder","Age",1,"w-full","rounded-md","border","border-[#e0e0e0]","bg-white","py-1.5","px-3","text-base","font-normal","text-[14px]","text-[#6B7280]","outline-none","focus:border-[#6A64F1]","focus:shadow-md"],["for","patientMobileNo",1,"mb-2","block","font-medium","text-[14px]","text-[#07074D]"],["autocomplete","off","maxlength","11","minlength","11","formControlName","patientMobileNo","id","patientMobileNo","placeholder","Patient Mobile No",1,"w-full","rounded-md","border","border-[#e0e0e0]","bg-white","py-1.5","px-3","text-base","font-normal","text-[14px]","text-[#6B7280]","outline-none","focus:border-[#6A64F1]","focus:shadow-md"],["for","date",1,"mb-2","block","font-medium","text-[14px]","text-[#07074D]"],["formControlName","gender","name","gender","id","gender",1,"w-full","rounded-md","border","border-[#e0e0e0]","bg-white","py-2","px-3","text-base","font-normal","text-[14px]","text-[#6B7280]","outline-none","focus:border-[#6A64F1]","focus:shadow-md"],["value","0",1,"font-semibold","text-gray-500"],[3,"value",4,"ngFor","ngForOf"],["class","text-[14px] text-red-600",4,"ngIf"],["for","bloodGroup",1,"mb-2","block","font-medium","text-[14px]","text-[#07074D]"],["formControlName","bloodGroup","name","bloodGroup","id","bloodGroup",1,"w-full","rounded-md","border","border-[#e0e0e0]","bg-white","py-2","px-3","text-base","font-normal","text-[14px]","text-[#6B7280]","outline-none","focus:border-[#6A64F1]","focus:shadow-md"],["value","A+",1,"font-semibold","text-gray-500"],["value","A-",1,"font-semibold","text-gray-500"],["value","B+",1,"font-semibold","text-gray-500"],["value","B-",1,"font-semibold","text-gray-500"],["value","O+",1,"font-semibold","text-gray-500"],["value","O-",1,"font-semibold","text-gray-500"],["value","AB+",1,"font-semibold","text-gray-500"],["value","AB-",1,"font-semibold","text-gray-500"],["value","others",1,"font-semibold","text-gray-500"],[1,"flex","gap-5"],[1,"btn-secondary","py-2","mt-6",3,"click"],[1,"btn-secondary","bg-primary","py-2","mt-6",3,"click"],["class","flex items-center gap-1 tetx-white",4,"ngIf"],["class","loading loading-dots loading-md",4,"ngIf"],[3,"bookingInfo","gotToBack"],["type","radio","formControlName","bookMyself","id","bookMyself","value","bookMyself","required","",1,"hidden","peer"],["for","bookMyself",1,"inline-flex","items-center","justify-between","w-full","p-5","text-gray-500","bg-white","border","border-gray-200","rounded-lg","cursor-pointer","peer-checked:border-blue-600","peer-checked:text-blue-600","hover:text-gray-600","hover:bg-gray-100"],[1,"fa-solid","fa-person","text-[44px]"],[1,"flex","justify-between"],[1,"grid","grid-cols-5","gap-4"],[1,"col-span-1","rounded-full","w-[50px]","h-[50px]","overflow-hidden","border-secondary","border-2"],["width","50","height","50","alt","",1,"w-full","h-full","object-cover",3,"ngSrc"],[1,"col-span-4"],[1,"heading","text-[20px]"],[1,"py-0","px-3"],[1,"leading-0"],[1,"stat-title"],[1,"stat-value","text-secondary","text[24px]"],[1,"h-px","my-8","bg-gray-200","border-0"],["matInput","","formControlName","appointmentDate","placeholder","Appointment Date",1,"w-full","rounded-md","border","border-[#e0e0e0]","bg-white","py-1.5","px-3","text-base","font-normal","text-[14px]","text-[#6B7280]","outline-none","focus:border-[#6A64F1]","focus:shadow-md",3,"matDatepickerFilter","matDatepicker","max","min","click"],["picker",""],["for","doctorScheduleType",1,"mb-2","block","font-medium","text-[14px]","text-[#07074D]"],["formControlName","doctorScheduleType","name","doctorScheduleType","id","doctorScheduleType",1,"w-full","rounded-md","border","border-[#e0e0e0]","bg-white","py-2","px-3","text-base","font-normal","text-[14px]","text-[#6B7280]","outline-none","focus:border-[#6A64F1]","focus:shadow-md"],["class","font-semibold text-gray-500",3,"value",4,"ngFor","ngForOf"],["formControlName","appointmentType","name","appointmentType","id","appointmentType",1,"w-full","rounded-md","border","border-[#e0e0e0]","bg-white","py-2","px-3","text-base","font-normal","text-[14px]","text-[#6B7280]","outline-none","focus:border-[#6A64F1]","focus:shadow-md"],[1,"flex","gap-5","mt-10","w-full"],[1,"btn-secondary","py-2","bg-primary/90",3,"click"],[1,"btn-secondary","py-2",3,"click"],[1,"text-[14px]","text-red-600"],[1,"font-semibold","text-gray-500",3,"value"],[1,"font-Roboto","text-[16px]","text-primary/90"],[1,"mt-2"],["for","",1,"label"],[1,"form_input",3,"value","input"],["value",""],[3,"value"],[1,"text-red-600","text-sm"],[1,"flex","items-center","gap-1","tetx-white"],[1,"loading","loading-dots","loading-md"]],template:function(n,m){n&1&&g(0,ct,17,0,"div",0)(1,Ot,9,3,"div",1),n&2&&(d("ngIf",!m.doctorData.isAuthUser),s(),d("ngIf",m.doctorData.isAuthUser))},dependencies:[ge,he,ye,Ie,Ee,xe,De,ke,be,Se,Fe,Te,Pe,we,Ce,ve,Ue,We,Ye,ze,et,$e,Qe,_e],styles:[".mat-horizontal-stepper-header-container{display:none!important}  .mat-horizontal-content-container{padding:0!important}input[type=radio][_ngcontent-%COMP%]:checked + .radio-card[_ngcontent-%COMP%]{background:#006c93;color:#fff}"]});let o=a;return o})();export{di as a};
