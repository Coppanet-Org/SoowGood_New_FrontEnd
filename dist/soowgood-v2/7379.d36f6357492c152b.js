"use strict";(self.webpackChunksoowgood_v2=self.webpackChunksoowgood_v2||[]).push([[7379],{7379:(P,w,i)=>{i.r(w),i.d(w,{LoginModule:()=>$});var f=i(6814),u=i(6223),c=i(1329),p=i(553),T=i(7874),e=i(9212),n=i(9245),m=i(7552),S=i(2547),Z=i(2598),I=i(9460),x=i(8184),E=i(9802),J=i(9483),q=i(9862),A=i(9157),L=i(2032);function M(t,g){1&t&&(e.TgZ(0,"mat-error",31),e._uU(1," You must enter a valid mobile number. "),e.qZA())}function O(t,g){1&t&&(e.TgZ(0,"mat-error",32),e._uU(1," Mobile number should have exactly 11 digits and follow the Bangladeshi format. "),e.qZA())}function Y(t,g){if(1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t){const a=e.oxw();let l;e.xp6(),e.hij(" ",null==(l=a.loginForm.get("mobileNo"))?null:l.getError("customError")," ")}}function k(t,g){1&t&&(e.TgZ(0,"mat-error"),e._uU(1," Password is required. "),e.qZA())}function Q(t,g){1&t&&(e.TgZ(0,"mat-error"),e._uU(1," Password must start with an uppercase letter. "),e.qZA())}function B(t,g){1&t&&(e.TgZ(0,"mat-error"),e._uU(1," Password must be at least 6 characters long. "),e.qZA())}function j(t,g){1&t&&(e.TgZ(0,"mat-error"),e._uU(1," Password must include a special character. "),e.qZA())}function D(t,g){1&t&&(e.TgZ(0,"mat-error"),e._uU(1," Password must include a number. "),e.qZA())}function V(t,g){if(1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t){const a=e.oxw();let l;e.xp6(),e.hij(" ",null==(l=a.loginForm.get("password"))?null:l.getError("customError")," ")}}function K(t,g){if(1&t&&(e.TgZ(0,"div",33),e._UZ(1,"i",34),e._uU(2),e.qZA()),2&t){const a=e.oxw();e.xp6(2),e.hij(" ",a.errorMessage," ")}}function G(t,g){1&t&&(e.TgZ(0,"div",35)(1,"span"),e._uU(2,"Login"),e.qZA(),e._UZ(3,"i",36),e.qZA())}function z(t,g){1&t&&e._UZ(0,"span",37)}const F=t=>({"border-red-500":t}),W=[{path:"",component:(()=>{class t{constructor(a,l,r,h,d,v,y,o,s,b,_,N){this.authService=a,this.appAuthService=l,this.oAuthService=r,this.doctorProfileService=h,this.PatientProfileService=d,this.fb=v,this._router=y,this.ActivatedRoute=o,this.ToasterService=s,this.NormalAuth=b,this.UserAccountsService=_,this.http=N,this.defaultAuth={mobileNo:"",password:""},this.formSubmitted=!1,this.errorMessage="",this.loginDto={},this.hasError=!1,this.subs=new c.Y,this.isLoading=!1,this.passwordFieldType="password",this.confirmPasswordFieldType="password",this.changePasswordShow=!1,this.resetModalShow=!1,this.resetLoading=!1,this.resetFormSubmitted=!1,this.resetPasswordFieldType="password",this.resetConfPasswordFieldType="password",this.key=p.Re}ngOnInit(){this.initForm()}get formControl(){return this.loginForm.controls}goToForgotPassword(){this._router.navigate(["/forgot-password"],{queryParams:{redirect:"login"}})}initForm(){this.loginForm=this.fb.group({mobileNo:[this.defaultAuth.mobileNo,[u.kI.required,u.kI.pattern(/(^(\+88|0088)?(01){1}[3456789]{1}(\d){8})$/)]],password:[this.defaultAuth.password,u.kI.required]})}passwordVisibility(a){"password"===a?this.passwordFieldType="password"===this.passwordFieldType?"text":"password":"confirmPassword"===a&&(this.confirmPasswordFieldType="password"===this.confirmPasswordFieldType?"text":"password")}onSubmit(){const a=this.ActivatedRoute.snapshot.queryParams.redirect;if(this.formSubmitted=!0,!this.loginForm.valid&&!this.loginForm.touched)return this.ToasterService.customToast("Please fill in all required fields","warning"),void(this.isLoading=!1);{if(this.loginForm.invalid)return void(this.isLoading=!1);this.formSubmitted=!1,this.isLoading=!0;let l="";this.errorMessage="",this.hasError=!1;const r=this.formControl.mobileNo.value,h=this.formControl.password.value;this.oAuthService.oidc=!1,this.loginDto.userName=r,this.loginDto.email="",this.loginDto.password=h,this.loginDto.rememberMe=!1;try{this.appAuthService.isLoadingSubject.next(!0),this.oAuthService.fetchTokenUsingPasswordFlowAndLoadUserProfile(r,h).then(d=>{console.log(d),d&&"Agent"!==d?.info?.role&&(this.appAuthService.createUserModel(d),r.split("@"),this.authService.loginByUserDto(this.loginDto).subscribe(o=>{if(this.loginResponse=o,this.loginResponse.message.includes("User Name Or Password is not correct !"))return this.ToasterService.customToast(String(this.loginResponse.message),"warning"),void(this.isLoading=!1);o.success&&"Doctor"==o.roleName[0]?(this.isLoading=!1,this.subs.sink=this.doctorProfileService.getByUserName(o.userName?o.userName:"").subscribe(s=>{let b={identityNumber:s.identityNumber,fullName:s.fullName,bmdcRegNo:s.bmdcRegNo,isActive:s.isActive,userId:s.userId,id:s.id,specialityId:s.specialityId,profileStep:s.profileStep,createFrom:s.createFrom,userType:o.roleName.toString().toLowerCase()};this.NormalAuth.setAuthInfoInLocalStorage(b),l=1==s.profileStep||2==s.profileStep?"/signup":s.isActive?o.roleName.toString()+"/dashboard":o.roleName.toString()+"/profile-settings/basic-info",a?this.navigateToNextJS(a):this._router.navigate([l.toLowerCase()],{state:{data:s}}).then(()=>{this.ToasterService.customToast(o.message?o.message:" ","success")})},s=>{this.handleProfileError(s)})):o.success&&"Patient"==o.roleName[0]?(this.isLoading=!1,this.subs.sink=this.PatientProfileService.getByUserName(o.userName?o.userName:"").subscribe(s=>{let b={fullName:s.fullName,userId:s.userId,id:s.id,userpc:this.encrypt(String(s.mobileNo)),userType:o.roleName.toString().toLowerCase()};this.NormalAuth.setAuthInfoInLocalStorage(b);let _=o.roleName.toString()+"/dashboard";a?this.navigateToNextJS(a):this._router.navigate([_.toLowerCase()],{state:{data:s}}).then(()=>{this.ToasterService.customToast(o.message?o.message:" ","success")})},s=>{this.handleProfileError(s)})):(this.hasError=!0,this.ToasterService.customToast(o.message?o.message:" ","error"),this.isLoading=!1)})),"Agent"===d?.info.role&&(this.hasError=!0,this.isLoading=!1,this.errorMessage="You are a Agent!. Please login from Agent portal.")}).catch(d=>{this.hasError=!0,this.appAuthService.isLoadingSubject.next(!1),this.errorMessage=d.error.error_description||d.error.error,this.isLoading=!1})}catch(d){this.hasError=!0,"'tokenEndpoint' should not be null"===d.message&&(this.errorMessage="Identity server is not running")}}}encrypt(a){return T.AES.encrypt(a,this.key).toString()}navigateToNextJS(a){const l=localStorage.getItem("access_token");window.open(`http://localhost:3000/${a}?token=${l}`,"_blank")}handleProfileError(a){this.errorMessage="","There is no entity DoctorProfile with id = !"===a.error.error.message?this.errorMessage="User not found":this.ToasterService.customToast(String(a.error.error.message),"error")}ngOnDestroy(){this.subs.unsubscribe()}static#e=this.\u0275fac=function(l){return new(l||t)(e.Y36(n.V),e.Y36(Z.K),e.Y36(I.Ct),e.Y36(m.K),e.Y36(S.j),e.Y36(u.qu),e.Y36(x.F0),e.Y36(x.gz),e.Y36(E.G),e.Y36(J.e),e.Y36(n.V),e.Y36(q.eN))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-login"]],decls:52,vars:23,consts:[[1,"grid","h-screen","items-center","bg-primary","grid-cols-1","lg:grid-cols-2"],[1,"hidden","w-full","overflow-hidden","h-full","lg:block"],["ngSrc","/assets/auth/login-auth.webp","width","400","height","400","alt","auth","priority","",1,"w-full","h-fit","object-cover"],[1,"drop-shadow-soft","relative"],[1,"relative","max-w-[500px]","mx-auto","mt-10","bg-white","p-8","rounded-xl","shadow","shadow-slate-300"],["width","70","height","70","ngSrc","/assets/auth/ms-icon-310x310.png","alt","icon",1,"md:w-[80px]","w-[70px]","lg:w-[100px]","rounded-full","border-2","border-white","lg:h-[100px]","md:h-[80px]","h-[70px]","absolute","-top-[40px]","lg:-top-[60px]","left-1/2","-translate-x-1/2"],[1,"text-2xl","md:text-3xl","lg:text-4xl","font-semibold","font-Roboto","text-primary","md:mt-6","lg:mt-8"],[1,"text-slate-500","mt-2"],[1,"lg:mt-6",3,"formGroup","submit"],[1,"flex","flex-col","space-y-5","mt-6","lg:mt-10"],["for","mobile"],[1,"font-medium","text-slate-700","pb-2"],[1,"form_input","flex","h-[40px]","bg-slate-100",3,"ngClass"],["matPrefix","",1,"h-fit","font-Roboto","text-[14px]","lg:text-[16px]"],["autocomplete","off","matInput","","maxlength","11","type","tel","formControlName","mobileNo","id","mobileNo","placeholder","018-000-00000","required","","inputmode","numeric",1,"w-full","bg-transparent","border-none","outline-none","font-Roboto","h-fit","font-semibold","text-[14px]","lg:text-[16px]"],["class","text-red-600",4,"ngIf"],["class","text-red-500",4,"ngIf"],[4,"ngIf"],["for","Password"],[1,"form_input","flex","justify-between","bg-slate-100",3,"ngClass"],["autocomplete","off","formControlName","password","name","password","id","password","placeholder","Password123@*",1,"outline-none","border-none","w-full","bg-transparent","text-[14px]","lg:text-[16px]",3,"type"],[1,"cursor-pointer",3,"click"],[1,"flex","flex-col"],["class","p-4 mb-4 text-sm text-yellow-800 rounded-lg bg-yellow-50 font-semibold font-Roboto","role","alert",4,"ngIf"],["type","submit",1,"form_btn","disabled:bg-gray-500","disabled:select-none",3,"disabled"],["class","flex items-center",4,"ngIf"],["class","loading loading-dots loading-md",4,"ngIf"],[1,"text-center"],["routerLink","/signup",1,"text-primary","font-medium","inline-flex","space-x-1","items-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"h-4","w-4"],["stroke-linecap","round","stroke-linejoin","round","d","M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"],[1,"text-red-600"],[1,"text-red-500"],["role","alert",1,"p-4","mb-4","text-sm","text-yellow-800","rounded-lg","bg-yellow-50","font-semibold","font-Roboto"],[1,"fa-solid","fa-circle-exclamation","mr-2"],[1,"flex","items-center"],[1,"fa-solid","ml-2","fa-right-to-bracket"],[1,"loading","loading-dots","loading-md"]],template:function(l,r){if(1&l&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"img",2),e.qZA(),e.TgZ(3,"div",3)(4,"div",4),e._UZ(5,"img",5),e.TgZ(6,"h1",6),e._uU(7," Login "),e.qZA(),e.TgZ(8,"p",7),e._uU(9,"Hi, Welcome to SoowGood \u{1f44b}"),e.qZA(),e.TgZ(10,"form",8),e.NdJ("submit",function(){return r.onSubmit()}),e.TgZ(11,"div",9)(12,"label",10)(13,"p",11),e._uU(14,"Mobile Number"),e.qZA(),e.TgZ(15,"div",12)(16,"span",13),e._uU(17,"+88 \xa0"),e.qZA(),e._UZ(18,"input",14),e.qZA(),e.YNc(19,M,2,0,"mat-error",15)(20,O,2,0,"mat-error",16)(21,Y,2,1,"mat-error",17),e.qZA(),e.TgZ(22,"label",18)(23,"p",11),e._uU(24,"Password"),e.qZA(),e.TgZ(25,"div",19),e._UZ(26,"input",20),e.TgZ(27,"span",21),e.NdJ("click",function(){return r.passwordVisibility("password")}),e._UZ(28,"i"),e.qZA()(),e.TgZ(29,"div",22),e.YNc(30,k,2,0,"mat-error",17)(31,Q,2,0,"mat-error",17)(32,B,2,0,"mat-error",17)(33,j,2,0,"mat-error",17)(34,D,2,0,"mat-error",17)(35,V,2,1,"mat-error",17),e.qZA()(),e.YNc(36,K,3,1,"div",23),e.TgZ(37,"button",24),e.YNc(38,G,4,0,"div",25)(39,z,1,0,"span",26),e.qZA(),e.TgZ(40,"p"),e._uU(41," Forgot your password?"),e.TgZ(42,"strong",21),e.NdJ("click",function(){return r.goToForgotPassword()}),e._uU(43," Reset now"),e.qZA()(),e.TgZ(44,"p",27),e._uU(45," Don't have an account? "),e.TgZ(46,"a",28)(47,"span"),e._uU(48,"Sign up "),e.qZA(),e.TgZ(49,"span"),e.O4$(),e.TgZ(50,"svg",29),e._UZ(51,"path",30),e.qZA()()()()()()()()()),2&l){let h,d,v,y,o,s,b,_,N,U,C;e.xp6(10),e.Q6J("formGroup",r.loginForm),e.xp6(5),e.Q6J("ngClass",e.VKq(19,F,(null==(h=r.loginForm.get("mobileNo"))?null:h.invalid)&&(null==(h=r.loginForm.get("mobileNo"))?null:h.touched))),e.xp6(4),e.Q6J("ngIf",(null==(d=r.loginForm.get("mobileNo"))?null:d.hasError("required"))&&(null==(d=r.loginForm.get("mobileNo"))?null:d.touched)),e.xp6(),e.Q6J("ngIf",(null==(v=r.loginForm.get("mobileNo"))?null:v.hasError("pattern"))&&(null==(v=r.loginForm.get("mobileNo"))?null:v.touched)),e.xp6(),e.Q6J("ngIf",null==(y=r.loginForm.get("mobileNo"))?null:y.hasError("customError")),e.xp6(4),e.Q6J("ngClass",e.VKq(21,F,(null==(o=r.loginForm.get("password"))?null:o.invalid)&&(null==(o=r.loginForm.get("password"))?null:o.touched))),e.xp6(),e.Q6J("type",r.passwordFieldType),e.xp6(2),e.Tol("password"===r.passwordFieldType?"fa fa-eye-slash":"fa fa-eye"),e.xp6(2),e.Q6J("ngIf",r.formSubmitted&&(null==(s=r.loginForm.get("password"))?null:s.hasError("required"))),e.xp6(),e.Q6J("ngIf",r.formSubmitted&&(null==(b=r.loginForm.get("password"))?null:b.hasError("startsWithUppercase"))),e.xp6(),e.Q6J("ngIf",r.formSubmitted&&(null==(_=r.loginForm.get("password"))?null:_.hasError("isAtLeast6Characters"))),e.xp6(),e.Q6J("ngIf",r.formSubmitted&&(null==(N=r.loginForm.get("password"))?null:N.hasError("includesSpecialCharacter"))),e.xp6(),e.Q6J("ngIf",r.formSubmitted&&(null==(U=r.loginForm.get("password"))?null:U.hasError("includesNumber"))),e.xp6(),e.Q6J("ngIf",null==(C=r.loginForm.get("password"))?null:C.hasError("customError")),e.xp6(),e.Q6J("ngIf",r.errorMessage),e.xp6(),e.Q6J("disabled",r.isLoading||!r.loginForm.dirty||r.loginForm.invalid),e.xp6(),e.Q6J("ngIf",!r.isLoading),e.xp6(),e.Q6J("ngIf",r.isLoading)}},dependencies:[f.mk,f.O5,x.rH,u._Y,u.Fj,u.JJ,u.JL,u.Q7,u.nD,u.sg,u.u,A.TO,A.qo,L.Nt,f.Zd],styles:[".signup-form__left[_ngcontent-%COMP%]{width:49.3%;height:100%}.signup-form__left[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}"]})}return t})()}];let $=(()=>{class t{static#e=this.\u0275fac=function(l){return new(l||t)};static#t=this.\u0275mod=e.oAB({type:t});static#r=this.\u0275inj=e.cJS({imports:[f.ez,x.Bz.forChild(W),u.u5,u.UX,A.lN,L.c]})}return t})()},9245:(P,w,i)=>{i.d(w,{V:()=>c});var f=i(9212),u=i(8175);let c=(()=>{class p{constructor(e){this.restService=e,this.apiName="Default",this.decodeJwtByJwt=(n,m)=>this.restService.request({method:"POST",url:"/api/app/user-accounts/decode-jwt",body:n},{apiName:this.apiName,...m}),this.isUserExistsByUserName=(n,m)=>this.restService.request({method:"POST",url:"/api/app/user-accounts/is-user-exists",params:{userName:n}},{apiName:this.apiName,...m}),this.loginByUserDto=(n,m)=>this.restService.request({method:"POST",url:"/api/app/user-accounts/login",body:n},{apiName:this.apiName,...m}),this.refreshAccessTokenByUser=(n,m)=>this.restService.request({method:"POST",url:"/api/app/user-accounts/refresh-access-token",body:n},{apiName:this.apiName,...m}),this.resetPasswordByInputDto=(n,m)=>this.restService.request({method:"POST",url:"/api/app/user-accounts/reset-password",body:n},{apiName:this.apiName,...m}),this.resetPassword_AppByInputDto=(n,m)=>this.restService.request({method:"POST",url:"/api/app/user-accounts/reset-password_App",body:n},{apiName:this.apiName,...m}),this.signupUserByUserDtoAndPasswordAndRole=(n,m,S,Z)=>this.restService.request({method:"POST",url:"/api/app/user-accounts/signup-user",params:{password:m,role:S},body:n},{apiName:this.apiName,...Z}),this.userDataRemove=(n,m,S)=>this.restService.request({method:"POST",url:"/api/app/user-accounts/user-data-remove",params:{role:m},body:n},{apiName:this.apiName,...S})}static#e=this.\u0275fac=function(n){return new(n||p)(f.LFG(u.vgb))};static#t=this.\u0275prov=f.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"})}return p})()},1329:(P,w,i)=>{i.d(w,{Y:()=>u});var u=function(){function c(){this._subs=[]}return c.prototype.add=function(){for(var p=[],T=0;T<arguments.length;T++)p[T]=arguments[T];this._subs=this._subs.concat(p)},Object.defineProperty(c.prototype,"sink",{set:function(p){this._subs.push(p)},enumerable:!0,configurable:!0}),c.prototype.unsubscribe=function(){this._subs.forEach(function(p){return p&&function(c){return"function"==typeof c}(p.unsubscribe)&&p.unsubscribe()}),this._subs=[]},c}()}}]);