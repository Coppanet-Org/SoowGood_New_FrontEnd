import{a as _,g as A}from"./chunk-EFF4UWHC.js";import{e as S,h as C,p as T,x as w,z as E}from"./chunk-HL5HGHA3.js";import{a as I}from"./chunk-7LPMGZKA.js";import{Ca as b,Db as x,Eb as y,Ha as u,Sa as f,X as k,Xa as o,Ya as n,ac as h,fb as g,hb as v,tb as i,vb as m,ya as r,za as s}from"./chunk-TXQBTV46.js";function B(l,p){if(l&1&&i(0),l&2){let c=v();m(" ",c.bookingInfo==null?null:c.bookingInfo.doctorChamberName," ")}}function F(l,p){l&1&&i(0," Soowgood Online Platform ")}function z(l,p){if(l&1&&(o(0,"p",11),i(1),n()),l&2){let c=v();r(),m(" Booth Fee : ",c.bookingInfo==null?null:c.bookingInfo.agentFee," tk. ")}}var G=(()=>{let p=class p{constructor(t,a,e,d,D,P){this.ToasterService=t,this.AppointmentService=a,this.DoctorChamberService=e,this.AuthService=d,this.sslCommerzService=D,this.ekPayService=P,this.gotToBack=new b,this.sslInputDto={applicantCode:"",examFee:100,serviceCharge:0,customAmount:10,isCustomAmount:!1},this.hasValidCode=!1,this.sslCInputDto={},this.loading=!1,this.appointmentType=A.getEnumList(_)}ngOnInit(){this.userType=this.AuthService.authInfo().userType}getTitle(t,a){if(a=="appointmentType")return this.appointmentType.find(e=>e.id==t)}createAppointmentAndPayment(){this.loading=!0;try{this.AppointmentService.create(this.bookingInfo).subscribe({next:t=>{this.payWithSslCommerz(t.appointmentCode),localStorage.setItem("patientAppointmentCode",JSON.stringify(t.appointmentCode))},error:t=>{console.log(t),this.ToasterService.customToast(String(t.error.error.message),"error"),this.loading=!1}})}catch(t){console.log(t)}}payWithSslCommerz(t){if(this.bookingInfo){let a={};a.applicationCode=t,a.totalAmount=String(this.bookingInfo.totalAppointmentFee),a.transactionId="",this.ekPayService.initiateTestPayment(a).subscribe({next:e=>{e&&e.status==="1000"&&e.gatewayPageURL?(window.location.href=e.gatewayPageURL,this.loading=!1):(this.loading=!1,this.ToasterService.customToast("Unable to initiate your payment request. Please contact our support team.","error"))},error:e=>{this.loading=!1,this.ToasterService.customToast(String(e.error.error.message),"error")}})}else this.loading=!1,this.ToasterService.customToast("Booking info not found","error")}getDayOfWeek(t){return t=new Date(t),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()]}};p.\u0275fac=function(a){return new(a||p)(s(E),s(S),s(C),s(I),s(w),s(T))},p.\u0275cmp=k({type:p,selectors:[["app-booking-review"]],inputs:{bookingInfo:"bookingInfo"},outputs:{gotToBack:"gotToBack"},decls:42,vars:12,consts:[[1,"w-full","my-3","p-4","max-w-[450px]","border-[1px]","border-secondary-dark/50","rounded-lg","shadow","m-auto","custom-scrollbar","max-h-[470px]","overflow-y-scroll"],[1,"text-[26px]","font-semibold","text-primary","text-center"],[1,"text-[18px]","text-primary","text-center"],[1,"grid","grid-cols-1","gap-6","mt-5"],[1,"col-span-1"],[1,"mt-6","relative","grid","grid-cols-3","gap-6","text-center","place-items-center","justify-center","lg:text-left","bg-slate-100","pt-8","pb-4","px-4","border-[1px]","border-secondary-dark/50"],[1,"absolute","left-1/2","font-Roboto","font-semibold","text-primary","bg-white","rounded-full","-top-4","-translate-x-1/2","py-1","px-3","border-[1px]","border-secondary-dark/50"],[1,"text-center"],[1,"font-bold","text-primary"],[1,"text-sm","text-primary"],[1,"text-center","lg:text-left","mt-5"],[1,"mt-2","text-zinc-500"],["class","mt-2 text-zinc-500"],[1,"mt-2","text-zinc-700","text-[22px]","font-semibold"],[1,"mt-5","grid","grid-cols-2","gap-4"],[1,"btn-secondary","bg-primary","mt-6","text-[15px]","tracking-[1px]","py-1","w-full",3,"click"],[1,"btn-secondary","mt-6","text-[16px]","tracking-[1px]","py-2","w-full",3,"click"]],template:function(a,e){a&1&&(o(0,"div",0)(1,"h5",1),i(2),n(),o(3,"h2",2)(4,"span"),i(5," Patient name: "),n(),i(6),n(),o(7,"div",3)(8,"div",4)(9,"div",5)(10,"span",6),i(11,"Appointment"),n(),o(12,"div",7)(13,"p",8),i(14),x(15,"date"),n(),o(16,"p",9),i(17,"Date"),n()(),o(18,"div",7)(19,"p",8),u(20,B,1,1)(21,F,1,0),n(),o(22,"p",9),i(23,"Place"),n()(),o(24,"div",7)(25,"p",8),i(26),n(),o(27,"p",9),i(28,"Day"),n()()(),o(29,"div",10)(30,"p",11),i(31),n(),u(32,z,2,1,"p",12),o(33,"p",11),i(34),n(),o(35,"p",13),i(36),n()(),o(37,"div",14)(38,"button",15),g("click",function(){return e.gotToBack.emit(1)}),i(39," Back "),n(),o(40,"button",16),g("click",function(){return e.createAppointmentAndPayment()}),i(41),n()()()()()),a&2&&(r(2),m(" Dr. ",e.bookingInfo==null?null:e.bookingInfo.doctorName," "),r(4),m("",e.bookingInfo==null?null:e.bookingInfo.patientName," "),r(8),m(" ",y(15,10,e.bookingInfo==null?null:e.bookingInfo.appointmentDate)," "),r(6),f(20,e.bookingInfo!=null&&e.bookingInfo.doctorChamberName?20:21),r(6),m(" ",e.getDayOfWeek(e.bookingInfo==null?null:e.bookingInfo.appointmentDate)," "),r(5),m(" Doctor Fee : ",e.bookingInfo==null?null:e.bookingInfo.doctorFee," tk. "),r(),f(32,e.userType!=="patient"?32:-1),r(2),m(" Platform Fee : ",e.bookingInfo==null?null:e.bookingInfo.platformFee," tk. "),r(2),m(" Total : ",e.bookingInfo==null?null:e.bookingInfo.totalAppointmentFee," tk. "),r(5),m(" ",e.loading?"Loading...":"Confirm & Pay"," "))},dependencies:[h]});let l=p;return l})();export{G as a};
