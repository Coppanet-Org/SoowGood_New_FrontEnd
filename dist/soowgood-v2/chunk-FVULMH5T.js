import{a as _,g as A}from"./chunk-IBQVX35S.js";import{A as E,e as S,h as C,p as T,y as w}from"./chunk-GEVSPATW.js";import{a as I}from"./chunk-7LPMGZKA.js";import{Ca as k,Db as x,Eb as y,Ha as g,Sa as u,X as b,Xa as o,Ya as n,ac as h,fb as f,hb as v,tb as i,vb as m,ya as a,za as p}from"./chunk-TXQBTV46.js";function B(l,s){if(l&1&&i(0),l&2){let c=v();m(" ",c.bookingInfo==null?null:c.bookingInfo.doctorChamberName," ")}}function F(l,s){l&1&&i(0," Soowgood Online Platform ")}function j(l,s){if(l&1&&(o(0,"p",11),i(1),n()),l&2){let c=v();a(),m(" Booth Fee : ",c.bookingInfo==null?null:c.bookingInfo.agentFee," tk. ")}}var G=(()=>{let s=class s{constructor(t,r,e,d,D,P){this.ToasterService=t,this.AppointmentService=r,this.DoctorChamberService=e,this.AuthService=d,this.sslCommerzService=D,this.ekPayService=P,this.gotToBack=new k,this.sslInputDto={applicantCode:"",examFee:100,serviceCharge:0,customAmount:10,isCustomAmount:!1},this.hasValidCode=!1,this.sslCInputDto={},this.loading=!1,this.appointmentType=A.getEnumList(_)}ngOnInit(){this.userType=this.AuthService.authInfo().userType}getTitle(t,r){if(r=="appointmentType")return this.appointmentType.find(e=>e.id==t)}createAppointmentAndPayment(){this.loading=!0;try{this.AppointmentService.create(this.bookingInfo).subscribe({next:t=>{this.payWithSslCommerz(t.appointmentCode),localStorage.setItem("patientAppointmentCode",JSON.stringify(t.appointmentCode))},error:t=>{console.log(t),this.ToasterService.customToast(String(t.error.error.message),"error"),this.loading=!1}})}catch(t){console.log(t)}}payWithSslCommerz(t){if(this.bookingInfo){let r={};r.applicationCode=t,r.totalAmount=String(this.bookingInfo.totalAppointmentFee),r.transactionId="",this.sslCommerzService.initiateTestPayment(r).subscribe({next:e=>{e&&e.status==="SUCCESS"&&e.gatewayPageURL?(window.location.href=e.gatewayPageURL,this.loading=!1):(this.loading=!1,this.ToasterService.customToast("Unable to initiate your payment request. Please contact our support team.","error"))},error:e=>{this.loading=!1,this.ToasterService.customToast(String(e.error.error.message),"error")}})}else this.loading=!1,this.ToasterService.customToast("Booking info not found","error")}getDayOfWeek(t){return t=new Date(t),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()]}};s.\u0275fac=function(r){return new(r||s)(p(E),p(S),p(C),p(I),p(w),p(T))},s.\u0275cmp=b({type:s,selectors:[["app-booking-review"]],inputs:{bookingInfo:"bookingInfo"},outputs:{gotToBack:"gotToBack"},decls:44,vars:12,consts:[[1,"w-full","my-3","p-4","max-w-[470px]","border-[1px]","border-secondary-dark/50","rounded-lg","shadow","m-auto","custom-scrollbar","max-h-[470px]","overflow-y-scroll"],[1,"text-[26px]","font-semibold","text-primary","text-center"],[1,"text-[18px]","text-primary","text-center"],[1,"grid","grid-cols-1","gap-6","mt-5"],[1,"col-span-1"],[1,"mt-6","relative","grid","grid-cols-3","gap-6","text-center","place-items-center","justify-center","lg:text-left","bg-slate-100","pt-8","pb-4","px-4","border-[1px]","border-secondary-dark/50"],[1,"absolute","left-1/2","font-Roboto","font-semibold","text-primary","bg-white","rounded-full","-top-4","-translate-x-1/2","py-1","px-3","border-[1px]","border-secondary-dark/50"],[1,"text-center"],[1,"font-bold","text-primary"],[1,"text-sm","text-primary"],[1,"text-center","grid","gap-5","grid-cols-2","items-center","lg:text-left","mt-5"],[1,"mt-2","text-gray-500"],["class","mt-2 text-gray-500"],[1,"flex","justify-center"],[1,"mt-2","inline-block","text-secondary","text-[28px]","font-bold"],[1,"grid","grid-cols-2","gap-4"],[1,"btn-secondary","bg-primary","mt-6","text-[15px]","tracking-[1px]","py-1","w-full",3,"click"],[1,"btn-secondary","mt-6","text-[16px]","tracking-[1px]","py-2","w-full",3,"click"]],template:function(r,e){r&1&&(o(0,"div",0)(1,"h5",1),i(2),n(),o(3,"h2",2)(4,"span"),i(5," Patient name: "),n(),i(6),n(),o(7,"div",3)(8,"div",4)(9,"div",5)(10,"span",6),i(11,"Appointment"),n(),o(12,"div",7)(13,"p",8),i(14),x(15,"date"),n(),o(16,"p",9),i(17,"Date"),n()(),o(18,"div",7)(19,"p",8),g(20,B,1,1)(21,F,1,0),n(),o(22,"p",9),i(23,"Place"),n()(),o(24,"div",7)(25,"p",8),i(26),n(),o(27,"p",9),i(28,"Day"),n()()(),o(29,"div",10)(30,"div")(31,"p",11),i(32),n(),g(33,j,2,1,"p",12),o(34,"p",11),i(35),n()(),o(36,"div",13)(37,"p",14),i(38),n()()(),o(39,"div",15)(40,"button",16),f("click",function(){return e.gotToBack.emit(1)}),i(41," Back "),n(),o(42,"button",17),f("click",function(){return e.createAppointmentAndPayment()}),i(43),n()()()()()),r&2&&(a(2),m(" Dr. ",e.bookingInfo==null?null:e.bookingInfo.doctorName," "),a(4),m("",e.bookingInfo==null?null:e.bookingInfo.patientName," "),a(8),m(" ",y(15,10,e.bookingInfo==null?null:e.bookingInfo.appointmentDate)," "),a(6),u(20,e.bookingInfo!=null&&e.bookingInfo.doctorChamberName?20:21),a(6),m(" ",e.getDayOfWeek(e.bookingInfo==null?null:e.bookingInfo.appointmentDate)," "),a(6),m(" Doctor Fee : ",e.bookingInfo==null?null:e.bookingInfo.doctorFee," tk. "),a(),u(33,e.userType!=="patient"?33:-1),a(2),m(" Platform Fee : ",e.bookingInfo==null?null:e.bookingInfo.platformFee," tk. "),a(3),m(" Total : ",e.bookingInfo==null?null:e.bookingInfo.totalAppointmentFee," tk. "),a(5),m(" ",e.loading?"Loading...":"Confirm & Pay"," "))},dependencies:[h]});let l=s;return l})();export{G as a};
